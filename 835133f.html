<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta><title>RabbitMQ深度实践解析：从单体到集群的完整指南与多语言实战 - Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节.</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节."><meta name="msapplication-TileImage" content="/img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节."><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="前言消息队列扮演着至关重要的角色。RabbitMQ作为最受欢迎的开源消息代理之一，凭借其高可靠性、灵活的路由策略和丰富的生态系统，成为众多企业的首选。本文将从版本特性入手，深入探讨RabbitMQ的安装配置、集群搭建，并结合实际代码演示多语言调用方式，帮助初学和从业人员快速了解rabbitmq构建企业级完整的消息队列解决方案。 一、RabbitMQ版本演进与核心特性1.1 版本发展脉络Rabb"><meta property="og:type" content="blog"><meta property="og:title" content=" RabbitMQ深度实践解析：从单体到集群的完整指南与多语言实战"><meta property="og:url" content="https://www.wdft.com/835133f.html"><meta property="og:site_name" content="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节."><meta property="og:description" content="前言消息队列扮演着至关重要的角色。RabbitMQ作为最受欢迎的开源消息代理之一，凭借其高可靠性、灵活的路由策略和丰富的生态系统，成为众多企业的首选。本文将从版本特性入手，深入探讨RabbitMQ的安装配置、集群搭建，并结合实际代码演示多语言调用方式，帮助初学和从业人员快速了解rabbitmq构建企业级完整的消息队列解决方案。 一、RabbitMQ版本演进与核心特性1.1 版本发展脉络Rabb"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://www.wdft.com/assets/images/db.jpg"><meta property="article:published_time" content="2023-11-22T11:18:13.000Z"><meta property="article:modified_time" content="2026-01-12T08:58:59.875Z"><meta property="article:author" content="Jaco Liu"><meta property="article:tag" content="RabbitMQ"><meta property="article:tag" content="nosql"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/assets/images/db.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.wdft.com/835133f.html"},"headline":" RabbitMQ深度实践解析：从单体到集群的完整指南与多语言实战","image":["https://www.wdft.com/assets/images/db.jpg"],"datePublished":"2023-11-22T11:18:13.000Z","dateModified":"2026-01-12T08:58:59.875Z","author":{"@type":"Person","name":"Jaco Liu"},"publisher":{"@type":"Organization","name":"Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节.","logo":{"@type":"ImageObject","url":"https://www.wdft.com/img/logo.svg"}},"description":"前言消息队列扮演着至关重要的角色。RabbitMQ作为最受欢迎的开源消息代理之一，凭借其高可靠性、灵活的路由策略和丰富的生态系统，成为众多企业的首选。本文将从版本特性入手，深入探讨RabbitMQ的安装配置、集群搭建，并结合实际代码演示多语言调用方式，帮助初学和从业人员快速了解rabbitmq构建企业级完整的消息队列解决方案。 一、RabbitMQ版本演进与核心特性1.1 版本发展脉络Rabb"}</script><link rel="canonical" href="https://www.wdft.com/835133f.html"><link rel="alternate" href="/atom.xml" title="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节." type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.15.2/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><script>!function(){var e=document.createElement("script"),t=(e.src="//hm.baidu.com/hm.js?45914c5ebb523a9ed07ab35e4dc81374",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><meta name="msvalidate.01" content="ad0df3c8d20f49daaeb5baa3c9dbfe75"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8952360410310192" crossorigin="anonymous"></script><script>!function(){function e(){if(location.hash){Array.from(document.querySelectorAll(".tab-content")).forEach(e=>{e.classList.add("is-hidden")}),Array.from(document.querySelectorAll(".tabs li")).forEach(e=>{e.classList.remove("is-active")});const e=document.querySelector(location.hash),t=(e&&e.classList.remove("is-hidden"),document.querySelector(`a[href="${location.hash}"]`));t&&t.parentElement.classList.add("is-active")}}e(),window.addEventListener("hashchange",e,!1)}()</script><meta name="generator" content="Hexo 6.1.0"></head><body class="is-2-column"><img src="/img/avatar.jpeg" width="0" height="0"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节." height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/musics">Musics</a><a class="navbar-item" href="/videos">Videos</a><a class="navbar-item" href="/galleries">Galleries</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item dark-mode-btn" title="Light|Dark" rel="noopener" onclick="switchDarkMode()">    <i class="fas fa-lightbulb">  </i></a><a class="navbar-item" target="_blank" rel="noopener" title="Musics" href="/musics"><i class="fas fa-music"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Videos" href="/videos"><i class="fas fa-video"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="WeChat Account (labsec)" href="/assets/images/about/ljq-qrcode.jpeg"><i class="fab fa-weixin"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Jaco Liu GitHub" href="https://github.com/ljq"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="/assets/images/db.jpg" alt=" RabbitMQ深度实践解析：从单体到集群的完整指南与多语言实战"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2023-11-22T11:18:13.000Z" title="11/22/2023, 7:18:13 PM">2023-11-22</time></span><span class="level-item">Updated&nbsp;<time datetime="2026-01-12T08:58:59.875Z" title="1/12/2026, 4:58:59 PM">2026-01-12</time></span><span class="level-item"> Jaco Liu </span><span class="level-item"><a class="link-muted" href="/categories/nosql/">nosql</a></span><span class="level-item">35 minutes read (About 5270 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">RabbitMQ深度实践解析：从单体到集群的完整指南与多语言实战</h1><div class="content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>消息队列扮演着至关重要的角色。RabbitMQ作为最受欢迎的开源消息代理之一，凭借其高可靠性、灵活的路由策略和丰富的生态系统，成为众多企业的首选。本文将从版本特性入手，深入探讨RabbitMQ的安装配置、集群搭建，并结合实际代码演示多语言调用方式，帮助初学和从业人员快速了解rabbitmq构建企业级完整的消息队列解决方案。</p><h2 id="一、RabbitMQ版本演进与核心特性"><a href="#一、RabbitMQ版本演进与核心特性" class="headerlink" title="一、RabbitMQ版本演进与核心特性"></a>一、RabbitMQ版本演进与核心特性</h2><h3 id="1-1-版本发展脉络"><a href="#1-1-版本发展脉络" class="headerlink" title="1.1 版本发展脉络"></a>1.1 版本发展脉络</h3><p>RabbitMQ自2007年发布以来，经历了多个重要版本迭代：</p><ul><li><strong>3.8.x系列</strong>：引入Quorum Queues（仲裁队列），提供更强的数据一致性保证，取代传统的镜像队列</li><li><strong>3.9.x系列</strong>：增强K8s支持，改进Prometheus指标暴露，优化资源管理</li><li><strong>3.10.x系列</strong>（当前LTS）：大幅提升性能，支持AMQP 1.0，改进TLS 1.3支持，增强流控机制</li><li><strong>3.11.x系列</strong>：引入Streams（流式队列），提供无限存储能力，适合事件溯源和日志处理场景</li></ul><span id="more"></span><h3 id="1-2-3-10-x版本核心特性详解"><a href="#1-2-3-10-x版本核心特性详解" class="headerlink" title="1.2 3.10.x版本核心特性详解"></a>1.2 3.10.x版本核心特性详解</h3><p><strong>Quorum Queues</strong>：基于Raft共识算法实现，确保消息在集群节点间强一致性复制，即使在网络分区情况下也能保证数据安全。</p><p><strong>Lazy Queues</strong>：将消息直接存储到磁盘，减少内存占用，适合处理大量积压消息的场景。</p><p><strong>Prometheus集成</strong>：原生支持Prometheus监控，提供200+个指标，涵盖队列状态、连接数、消息速率等关键指标。</p><p><strong>TLS 1.3支持</strong>：提供更安全的通信加密，减少握手延迟，提升安全性。</p><p><strong>动态分片</strong>：基于负载自动进行队列分片，提升水平扩展能力。</p><h2 id="实验环境基本要求"><a href="#实验环境基本要求" class="headerlink" title="实验环境基本要求"></a>实验环境基本要求</h2><ul><li><code>Ubuntu 22.x</code> 或 <code>Debian 12.x</code></li><li><code>RabbitMQ 3.10.7</code></li><li><code>Erlang 24.3</code></li></ul><h2 id="二、RabbitMQ-CLI使用详解"><a href="#二、RabbitMQ-CLI使用详解" class="headerlink" title="二、RabbitMQ CLI使用详解"></a>二、RabbitMQ CLI使用详解</h2><h3 id="2-1-基础命令集"><a href="#2-1-基础命令集" class="headerlink" title="2.1 基础命令集"></a>2.1 基础命令集</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动/停止服务</span></span><br><span class="line">rabbitmq-server -detached  <span class="comment"># 后台启动</span></span><br><span class="line">rabbitmqctl stop</span><br><span class="line"></span><br><span class="line"><span class="comment"># 节点状态检查</span></span><br><span class="line">rabbitmqctl status</span><br><span class="line">rabbitmqctl environment  <span class="comment"># 查看环境配置</span></span><br><span class="line">rabbitmqctl cluster_status  <span class="comment"># 集群状态</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用户管理</span></span><br><span class="line">rabbitmqctl add_user admin securepass123</span><br><span class="line">rabbitmqctl set_user_tags admin administrator</span><br><span class="line">rabbitmqctl set_permissions -p / admin <span class="string">&quot;.*&quot;</span> <span class="string">&quot;.*&quot;</span> <span class="string">&quot;.*&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 队列操作</span></span><br><span class="line">rabbitmqctl list_queues name messages consumers</span><br><span class="line">rabbitmqctl list_exchanges</span><br><span class="line">rabbitmqctl list_bindings</span><br><span class="line"></span><br><span class="line"><span class="comment"># 插件管理</span></span><br><span class="line">rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_management  <span class="comment"># 启用管理插件</span></span><br><span class="line">rabbitmq-plugins list  <span class="comment"># 查看已安装插件</span></span><br></pre></td></tr></table></figure><h3 id="2-2-高级管理命令"><a href="#2-2-高级管理命令" class="headerlink" title="2.2 高级管理命令"></a>2.2 高级管理命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导出/导入配置</span></span><br><span class="line">rabbitmqctl export_definitions /tmp/rabbitmq-config.json</span><br><span class="line">rabbitmqctl import_definitions /tmp/rabbitmq-config.json</span><br><span class="line"></span><br><span class="line"><span class="comment"># 队列深度清理</span></span><br><span class="line">rabbitmqctl purge_queue my_queue_name</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接管理</span></span><br><span class="line">rabbitmqctl list_connections</span><br><span class="line">rabbitmqctl close_connection <span class="string">&quot;client_connection_id&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 镜像队列配置（旧版）</span></span><br><span class="line">rabbitmqctl set_policy ha-all <span class="string">&quot;^&quot;</span> <span class="string">&#x27;&#123;&quot;ha-mode&quot;:&quot;all&quot;&#125;&#x27;</span> --apply-to queues</span><br></pre></td></tr></table></figure><h3 id="2-3-实用技巧"><a href="#2-3-实用技巧" class="headerlink" title="2.3 实用技巧"></a>2.3 实用技巧</h3><ul><li><strong>查看详细日志</strong>：<code>rabbitmqctl environment | grep log</code></li><li><strong>性能调优</strong>：<code>rabbitmqctl eval &#39;rabbit_memory_monitor:force_gc().&#39;</code> 手动触发GC</li><li><strong>故障排查</strong>：<code>rabbitmq-diagnostics check_port_connectivity</code> 检查端口连通性</li></ul><h2 id="三、RabbitMQ使用注意事项"><a href="#三、RabbitMQ使用注意事项" class="headerlink" title="三、RabbitMQ使用注意事项"></a>三、RabbitMQ使用注意事项</h2><h3 id="3-1-生产环境避坑指南"><a href="#3-1-生产环境避坑指南" class="headerlink" title="3.1 生产环境避坑指南"></a>3.1 生产环境避坑指南</h3><p><strong>1. 消息持久化陷阱</strong></p><ul><li>仅队列持久化不够，必须同时设置消息持久化（delivery_mode&#x3D;2）</li><li>持久化会显著降低性能，每秒写入能力从10万+降至1-2万</li><li>解决方案：按业务重要性分级，核心业务用持久化，日志类用内存队列</li></ul><p><strong>2. 连接泄漏问题</strong></p><ul><li>客户端忘记关闭连接会导致文件描述符耗尽</li><li>最佳实践：使用连接池，设置合理的超时时间</li><li>监控指标：<code>rabbitmq_connections_opened_total</code> 和 <code>rabbitmq_connections_closed_total</code></li></ul><p><strong>3. 死信队列配置误区</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">x-dead-letter-exchange:</span> <span class="string">dlx_exchange</span></span><br><span class="line"><span class="attr">x-dead-letter-routing-key:</span> <span class="string">dlq.routing.key</span></span><br><span class="line"><span class="attr">x-message-ttl:</span> <span class="number">30000</span>  <span class="comment"># 30秒TTL</span></span><br></pre></td></tr></table></figure><ul><li>TTL单位是毫秒，不是秒</li><li>死信路由key可以为空，此时使用原始routing key</li></ul><p><strong>4. 内存告警阈值</strong></p><ul><li>默认内存使用达到40%会触发流控</li><li>调整配置：<code>vm_memory_high_watermark.relative = 0.6</code>（60%）</li><li>绝对值配置：<code>vm_memory_high_watermark.absolute = 2GB</code></li></ul><h3 id="3-2-性能优化建议"><a href="#3-2-性能优化建议" class="headerlink" title="3.2 性能优化建议"></a>3.2 性能优化建议</h3><ul><li><strong>预取计数（Prefetch Count）</strong>：设置合理的QoS，避免消费者过载</li><li><strong>批量确认</strong>：启用publisher confirm和consumer acknowledge批量处理</li><li><strong>连接复用</strong>：单个连接创建多个channel，避免频繁创建连接</li><li><strong>负载均衡</strong>：使用HAProxy或Nginx进行客户端连接负载均衡</li></ul><h2 id="四、单体RabbitMQ应用搭建"><a href="#四、单体RabbitMQ应用搭建" class="headerlink" title="四、单体RabbitMQ应用搭建"></a>四、单体RabbitMQ应用搭建</h2><h3 id="4-1-环境准备"><a href="#4-1-环境准备" class="headerlink" title="4.1 环境准备"></a>4.1 环境准备</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu 22.04安装</span></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y curl gnupg apt-transport-https</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加官方仓库</span></span><br><span class="line">curl -1sLf <span class="string">&quot;https://keys.openpgp.org/vks/v1/by-fingerprint/0A9AF2115F4687BD29803A206B73A36E6026DFCA&quot;</span> | sudo gpg --dearmor -o /usr/share/keyrings/com.rabbitmq.team.gpg</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;deb [signed-by=/usr/share/keyrings/com.rabbitmq.team.gpg] https://github.com/rabbitmq/signing-keys/releases/download/2.0/rabbitmq-server-3.10.x-ubuntu-jammy.list&quot;</span> | sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/rabbitmq.list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装RabbitMQ和Erlang</span></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y erlang-base rabbitmq-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动服务</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> rabbitmq-server</span><br><span class="line">sudo systemctl start rabbitmq-server</span><br></pre></td></tr></table></figure><h3 id="4-2-配置优化"><a href="#4-2-配置优化" class="headerlink" title="4.2 配置优化"></a>4.2 配置优化</h3><p><code>/etc/rabbitmq/rabbitmq.conf</code>:</p><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># 基础配置</span><br><span class="line">listeners.tcp.default = <span class="number">5672</span></span><br><span class="line">management.listener.port = <span class="number">15672</span></span><br><span class="line">management.listener.ssl = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"># 内存配置</span><br><span class="line">vm_memory_high_watermark.relative = <span class="number">0.6</span></span><br><span class="line">disk_free_limit.absolute = <span class="number">2</span>GB</span><br><span class="line"></span><br><span class="line"># 集群配置</span><br><span class="line">cluster_partition_handling = pause_minority</span><br><span class="line"></span><br><span class="line"># SSL配置</span><br><span class="line">ssl_options.verify = verify_peer</span><br><span class="line">ssl_options.fail_if_no_peer_cert = <span class="literal">false</span></span><br><span class="line">ssl_options.certfile = /etc/rabbitmq/cert.pem</span><br><span class="line">ssl_options.keyfile = /etc/rabbitmq/key.pem</span><br><span class="line">ssl_options.cacertfile = /etc/rabbitmq/ca.pem</span><br><span class="line"></span><br><span class="line"># 日志配置</span><br><span class="line">log.console.level = info</span><br><span class="line">log.file.level = debug</span><br><span class="line">log.file.rotation.date = $D0</span><br><span class="line">log.file.rotation.size = <span class="number">10485760</span></span><br></pre></td></tr></table></figure><h3 id="4-3-插件启用"><a href="#4-3-插件启用" class="headerlink" title="4.3 插件启用"></a>4.3 插件启用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启用管理界面</span></span><br><span class="line">rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_management</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启用延迟队列插件</span></span><br><span class="line">rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_delayed_message_exchange</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启用消息跟踪</span></span><br><span class="line">rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_tracing</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启服务</span></span><br><span class="line">sudo systemctl restart rabbitmq-server</span><br></pre></td></tr></table></figure><p>访问管理界面：<code>http://localhost:15672</code>，默认用户<code>guest/guest</code>（仅限本地访问）</p><h2 id="五、RabbitMQ集群搭建实战"><a href="#五、RabbitMQ集群搭建实战" class="headerlink" title="五、RabbitMQ集群搭建实战"></a>五、RabbitMQ集群搭建实战</h2><h3 id="5-1-集群架构设计"><a href="#5-1-集群架构设计" class="headerlink" title="5.1 集群架构设计"></a>5.1 集群架构设计</h3><p><strong>推荐架构</strong>：</p><ul><li>3节点集群（奇数节点，避免脑裂）</li><li>节点角色：全部为disc节点（磁盘节点）</li><li>网络要求：低延迟、高带宽内网，节点间端口开放4369、25672、35672-35682</li></ul><h3 id="5-2-集群搭建步骤"><a href="#5-2-集群搭建步骤" class="headerlink" title="5.2 集群搭建步骤"></a>5.2 集群搭建步骤</h3><p><strong>节点准备</strong>（三台服务器：rabbit1、rabbit2、rabbit3）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 所有节点执行</span></span><br><span class="line"><span class="comment"># 1. 配置hosts</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;192.168.1.101 rabbit1&quot;</span> &gt;&gt; /etc/hosts</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;192.168.1.102 rabbit2&quot;</span> &gt;&gt; /etc/hosts  </span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;192.168.1.103 rabbit3&quot;</span> &gt;&gt; /etc/hosts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 停止服务，清理数据</span></span><br><span class="line">sudo systemctl stop rabbitmq-server</span><br><span class="line">sudo <span class="built_in">rm</span> -rf /var/lib/rabbitmq/mnesia/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 同步Erlang Cookie</span></span><br><span class="line"><span class="comment"># 从rabbit1复制到其他节点</span></span><br><span class="line">sudo <span class="built_in">cat</span> /var/lib/rabbitmq/.erlang.cookie  <span class="comment"># 复制内容</span></span><br><span class="line"><span class="comment"># 在rabbit2、rabbit3上设置相同内容</span></span><br><span class="line">sudo <span class="built_in">echo</span> <span class="string">&quot;SAME_COOKIE_VALUE&quot;</span> &gt; /var/lib/rabbitmq/.erlang.cookie</span><br><span class="line">sudo <span class="built_in">chown</span> rabbitmq:rabbitmq /var/lib/rabbitmq/.erlang.cookie</span><br><span class="line">sudo <span class="built_in">chmod</span> 600 /var/lib/rabbitmq/.erlang.cookie</span><br></pre></td></tr></table></figure><p><strong>集群组建</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rabbit1作为主节点</span></span><br><span class="line">sudo systemctl start rabbitmq-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># rabbit2加入集群</span></span><br><span class="line">sudo systemctl start rabbitmq-server</span><br><span class="line">rabbitmqctl stop_app</span><br><span class="line">rabbitmqctl join_cluster rabbit@rabbit1</span><br><span class="line">rabbitmqctl start_app</span><br><span class="line"></span><br><span class="line"><span class="comment"># rabbit3加入集群</span></span><br><span class="line">sudo systemctl start rabbitmq-server</span><br><span class="line">rabbitmqctl stop_app</span><br><span class="line">rabbitmqctl join_cluster rabbit@rabbit1</span><br><span class="line">rabbitmqctl start_app</span><br></pre></td></tr></table></figure><p><strong>验证集群状态</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在任意节点执行</span></span><br><span class="line">rabbitmqctl cluster_status</span><br></pre></td></tr></table></figure><p>预期输出：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Cluster status of node rabbit@rabbit1 ...</span><br><span class="line">Basics</span><br><span class="line"></span><br><span class="line">Cluster name: rabbit@rabbit1</span><br><span class="line"></span><br><span class="line">Disk Nodes</span><br><span class="line"></span><br><span class="line">rabbit@rabbit1</span><br><span class="line">rabbit@rabbit2  </span><br><span class="line">rabbit@rabbit3</span><br><span class="line"></span><br><span class="line">Running Nodes</span><br><span class="line"></span><br><span class="line">rabbit@rabbit1</span><br><span class="line">rabbit@rabbit2</span><br><span class="line">rabbit@rabbit3</span><br><span class="line"></span><br><span class="line">Versions</span><br><span class="line"></span><br><span class="line">rabbit@rabbit1: RabbitMQ 3.10.7 on Erlang 24.3</span><br><span class="line">rabbit@rabbit2: RabbitMQ 3.10.7 on Erlang 24.3</span><br><span class="line">rabbit@rabbit3: RabbitMQ 3.10.7 on Erlang 24.3</span><br></pre></td></tr></table></figure><h3 id="5-3-高可用队列配置"><a href="#5-3-高可用队列配置" class="headerlink" title="5.3 高可用队列配置"></a>5.3 高可用队列配置</h3><p><strong>Quorum队列示例</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建仲裁队列</span></span><br><span class="line">rabbitmqctl declare_queue name=my_quorum_queue durable=<span class="literal">true</span> arguments=<span class="string">&#x27;&#123;&quot;x-queue-type&quot;:&quot;quorum&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>镜像队列（旧版兼容）</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建镜像策略</span></span><br><span class="line">rabbitmqctl set_policy ha-all <span class="string">&quot;^my_mirror_&quot;</span> <span class="string">&#x27;&#123;&quot;ha-mode&quot;:&quot;all&quot;, &quot;ha-sync-mode&quot;:&quot;automatic&quot;&#125;&#x27;</span> --apply-to queues</span><br></pre></td></tr></table></figure><h3 id="5-4-负载均衡配置"><a href="#5-4-负载均衡配置" class="headerlink" title="5.4 负载均衡配置"></a>5.4 负载均衡配置</h3><p><strong>HAProxy配置示例</strong> <code>/etc/haproxy/haproxy.cfg</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">frontend rabbitmq_front</span><br><span class="line">    bind *:5672</span><br><span class="line">    mode tcp</span><br><span class="line">    default_backend rabbitmq_back</span><br><span class="line"></span><br><span class="line">backend rabbitmq_back</span><br><span class="line">    mode tcp</span><br><span class="line">    balance roundrobin</span><br><span class="line">    server rabbit1 192.168.1.101:5672 check inter 5000 rise 2 fall 3</span><br><span class="line">    server rabbit2 192.168.1.102:5672 check inter 5000 rise 2 fall 3  </span><br><span class="line">    server rabbit3 192.168.1.103:5672 check inter 5000 rise 2 fall 3</span><br><span class="line"></span><br><span class="line">listen stats</span><br><span class="line">    bind *:8404</span><br><span class="line">    stats enable</span><br><span class="line">    stats uri /stats</span><br><span class="line">    stats refresh 5s</span><br></pre></td></tr></table></figure><h2 id="六、多语言客户端实践"><a href="#六、多语言客户端实践" class="headerlink" title="六、多语言客户端实践"></a>六、多语言客户端实践</h2><h3 id="6-1-PHP调用示例"><a href="#6-1-PHP调用示例" class="headerlink" title="6.1 PHP调用示例"></a>6.1 PHP调用示例</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Message</span>\<span class="title">AMQPMessage</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RabbitMQService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$connection</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$channel</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;connection = <span class="keyword">new</span> <span class="title class_">AMQPStreamConnection</span>(</span><br><span class="line">            <span class="string">&#x27;localhost&#x27;</span>, <span class="number">5672</span>, <span class="string">&#x27;guest&#x27;</span>, <span class="string">&#x27;guest&#x27;</span></span><br><span class="line">        );</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;channel = <span class="variable language_">$this</span>-&gt;connection-&gt;<span class="title function_ invoke__">channel</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">declareQueue</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$queueName</span>, <span class="keyword">bool</span> <span class="variable">$durable</span> = <span class="literal">true</span></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;channel-&gt;<span class="title function_ invoke__">queue_declare</span>(<span class="variable">$queueName</span>, <span class="literal">false</span>, <span class="variable">$durable</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">publish</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$queueName</span>, <span class="keyword">string</span> <span class="variable">$message</span>, <span class="keyword">array</span> <span class="variable">$headers</span> = []</span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="keyword">new</span> <span class="title class_">AMQPMessage</span>(<span class="variable">$message</span>, [</span><br><span class="line">            <span class="string">&#x27;delivery_mode&#x27;</span> =&gt; <span class="title class_">AMQPMessage</span>::<span class="variable constant_">DELIVERY_MODE_PERSISTENT</span>,</span><br><span class="line">            <span class="string">&#x27;application_headers&#x27;</span> =&gt; <span class="variable">$headers</span></span><br><span class="line">        ]);</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;channel-&gt;<span class="title function_ invoke__">basic_publish</span>(<span class="variable">$msg</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$queueName</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot; [x] Sent &#x27;<span class="subst">&#123;$message&#125;</span>&#x27;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">consume</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$queueName</span>, <span class="keyword">callable</span> <span class="variable">$callback</span></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;channel-&gt;<span class="title function_ invoke__">basic_qos</span>(<span class="literal">null</span>, <span class="number">1</span>, <span class="literal">null</span>); <span class="comment">// QoS设置</span></span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;channel-&gt;<span class="title function_ invoke__">basic_consume</span>(<span class="variable">$queueName</span>, <span class="string">&#x27;&#x27;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, function (<span class="variable">$msg</span>) <span class="keyword">use</span> ($<span class="title">callback</span>) &#123;</span><br><span class="line">            $<span class="title">callback</span>($<span class="title">msg</span>-&gt;<span class="title">body</span>, $<span class="title">msg</span>-&gt;<span class="title">get</span>(&#x27;<span class="title">application_headers</span>&#x27;));</span><br><span class="line">            <span class="variable">$msg</span>-&gt;<span class="title function_ invoke__">ack</span>(); <span class="comment">// 手动确认</span></span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> (<span class="variable language_">$this</span>-&gt;channel-&gt;<span class="title function_ invoke__">is_consuming</span>()) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;channel-&gt;<span class="title function_ invoke__">wait</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span>(<span class="params"></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;channel-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;connection-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="variable">$rabbit</span> = <span class="keyword">new</span> <span class="title class_">RabbitMQService</span>();</span><br><span class="line"><span class="variable">$rabbit</span>-&gt;<span class="title function_ invoke__">declareQueue</span>(<span class="string">&#x27;php_queue&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生产者</span></span><br><span class="line"><span class="variable">$rabbit</span>-&gt;<span class="title function_ invoke__">publish</span>(<span class="string">&#x27;php_queue&#x27;</span>, <span class="title function_ invoke__">json_encode</span>([</span><br><span class="line">    <span class="string">&#x27;event&#x27;</span> =&gt; <span class="string">&#x27;user_registered&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;user_id&#x27;</span> =&gt; <span class="number">123</span>,</span><br><span class="line">    <span class="string">&#x27;timestamp&#x27;</span> =&gt; <span class="title function_ invoke__">time</span>()</span><br><span class="line">]), [<span class="string">&#x27;priority&#x27;</span> =&gt; <span class="number">5</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 消费者</span></span><br><span class="line"><span class="variable">$rabbit</span>-&gt;<span class="title function_ invoke__">consume</span>(<span class="string">&#x27;php_queue&#x27;</span>, function(<span class="variable">$body</span>, <span class="variable">$headers</span>) &#123;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$body</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Received: &quot;</span> . <span class="variable">$data</span>[<span class="string">&#x27;event&#x27;</span>] . <span class="string">&quot; with priority: &quot;</span> . (<span class="variable">$headers</span>[<span class="string">&#x27;priority&#x27;</span>] ?? <span class="number">0</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable">$rabbit</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br></pre></td></tr></table></figure><h3 id="6-2-Python调用示例"><a href="#6-2-Python调用示例" class="headerlink" title="6.2 Python调用示例"></a>6.2 Python调用示例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Dict</span>, <span class="type">Any</span>, <span class="type">Callable</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RabbitMQClient</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">5672</span>, username=<span class="string">&#x27;guest&#x27;</span>, password=<span class="string">&#x27;guest&#x27;</span></span>):</span><br><span class="line">        self.credentials = pika.PlainCredentials(username, password)</span><br><span class="line">        self.connection_params = pika.ConnectionParameters(</span><br><span class="line">            host=host,</span><br><span class="line">            port=port,</span><br><span class="line">            credentials=self.credentials,</span><br><span class="line">            heartbeat=<span class="number">600</span>,</span><br><span class="line">            blocked_connection_timeout=<span class="number">300</span></span><br><span class="line">        )</span><br><span class="line">        self.connection = <span class="literal">None</span></span><br><span class="line">        self.channel = <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">connect</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;建立连接和通道&quot;&quot;&quot;</span></span><br><span class="line">        self.connection = pika.BlockingConnection(self.connection_params)</span><br><span class="line">        self.channel = self.connection.channel()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">declare_queue</span>(<span class="params">self, queue_name: <span class="built_in">str</span>, durable: <span class="built_in">bool</span> = <span class="literal">True</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;声明队列&quot;&quot;&quot;</span></span><br><span class="line">        self.channel.queue_declare(</span><br><span class="line">            queue=queue_name,</span><br><span class="line">            durable=durable,</span><br><span class="line">            arguments=&#123;</span><br><span class="line">                <span class="string">&#x27;x-queue-type&#x27;</span>: <span class="string">&#x27;quorum&#x27;</span>  <span class="comment"># 使用仲裁队列</span></span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">publish</span>(<span class="params">self, queue_name: <span class="built_in">str</span>, message: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>], headers: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>] = <span class="literal">None</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;发布消息&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> headers <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            headers = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        properties = pika.BasicProperties(</span><br><span class="line">            delivery_mode=<span class="number">2</span>,  <span class="comment"># 持久化消息</span></span><br><span class="line">            headers=headers,</span><br><span class="line">            content_type=<span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        self.channel.basic_publish(</span><br><span class="line">            exchange=<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            routing_key=queue_name,</span><br><span class="line">            body=json.dumps(message),</span><br><span class="line">            properties=properties</span><br><span class="line">        )</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot; [x] Sent message to <span class="subst">&#123;queue_name&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">consume</span>(<span class="params">self, queue_name: <span class="built_in">str</span>, callback: <span class="type">Callable</span>[[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>], <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]], <span class="literal">None</span>]</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;消费消息&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">ch, method, properties, body</span>):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                message = json.loads(body)</span><br><span class="line">                headers = properties.headers <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">                callback(message, headers)</span><br><span class="line">                ch.basic_ack(delivery_tag=method.delivery_tag)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Error processing message: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">                ch.basic_nack(delivery_tag=method.delivery_tag)</span><br><span class="line">        </span><br><span class="line">        self.channel.basic_qos(prefetch_count=<span class="number">1</span>)  <span class="comment"># QoS设置</span></span><br><span class="line">        self.channel.basic_consume(</span><br><span class="line">            queue=queue_name,</span><br><span class="line">            on_message_callback=on_message</span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot; [*] Waiting for messages on <span class="subst">&#123;queue_name&#125;</span>. To exit press CTRL+C&quot;</span>)</span><br><span class="line">        self.channel.start_consuming()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">close</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;关闭连接&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> self.channel <span class="keyword">and</span> self.channel.is_open:</span><br><span class="line">            self.channel.close()</span><br><span class="line">        <span class="keyword">if</span> self.connection <span class="keyword">and</span> self.connection.is_open:</span><br><span class="line">            self.connection.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用示例</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    client = RabbitMQClient()</span><br><span class="line">    client.connect()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 声明队列</span></span><br><span class="line">    client.declare_queue(<span class="string">&#x27;python_queue&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 发布消息</span></span><br><span class="line">    client.publish(<span class="string">&#x27;python_queue&#x27;</span>, &#123;</span><br><span class="line">        <span class="string">&#x27;action&#x27;</span>: <span class="string">&#x27;order_created&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;order_id&#x27;</span>: <span class="string">&#x27;ORD-12345&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;amount&#x27;</span>: <span class="number">99.99</span>,</span><br><span class="line">        <span class="string">&#x27;timestamp&#x27;</span>: time.time()</span><br><span class="line">    &#125;, headers=&#123;<span class="string">&#x27;priority&#x27;</span>: <span class="number">3</span>&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 定义消费者回调</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">message_handler</span>(<span class="params">message: <span class="built_in">dict</span>, headers: <span class="built_in">dict</span></span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Received message: <span class="subst">&#123;message&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Headers: <span class="subst">&#123;headers&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># 模拟处理时间</span></span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 开始消费（在实际应用中通常在单独的进程中）</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        client.consume(<span class="string">&#x27;python_queue&#x27;</span>, message_handler)</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Stopping consumer...&quot;</span>)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        client.close()</span><br></pre></td></tr></table></figure><h3 id="6-3-Go语言调用示例"><a href="#6-3-Go语言调用示例" class="headerlink" title="6.3 Go语言调用示例"></a>6.3 Go语言调用示例</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/streadway/amqp&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> RabbitMQ <span class="keyword">struct</span> &#123;</span><br><span class="line">	conn    *amqp.Connection</span><br><span class="line">	channel *amqp.Channel</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Message <span class="keyword">struct</span> &#123;</span><br><span class="line">	Event     <span class="type">string</span>    <span class="string">`json:&quot;event&quot;`</span></span><br><span class="line">	Data      any       <span class="string">`json:&quot;data&quot;`</span></span><br><span class="line">	Timestamp time.Time <span class="string">`json:&quot;timestamp&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewRabbitMQ</span><span class="params">(url <span class="type">string</span>)</span></span> (*RabbitMQ, <span class="type">error</span>) &#123;</span><br><span class="line">	conn, err := amqp.Dial(url)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;failed to connect to RabbitMQ: %w&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ch, err := conn.Channel()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		conn.Close()</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;failed to open channel: %w&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> &amp;RabbitMQ&#123;</span><br><span class="line">		conn:    conn,</span><br><span class="line">		channel: ch,</span><br><span class="line">	&#125;, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span></span> DeclareQueue(queueName <span class="type">string</span>, durable <span class="type">bool</span>) <span class="type">error</span> &#123;</span><br><span class="line">	_, err := r.channel.QueueDeclare(</span><br><span class="line">		queueName, <span class="comment">// name</span></span><br><span class="line">		durable,   <span class="comment">// durable</span></span><br><span class="line">		<span class="literal">false</span>,     <span class="comment">// delete when unused</span></span><br><span class="line">		<span class="literal">false</span>,     <span class="comment">// exclusive</span></span><br><span class="line">		<span class="literal">false</span>,     <span class="comment">// no-wait</span></span><br><span class="line">		amqp.Table&#123;</span><br><span class="line">			<span class="string">&quot;x-queue-type&quot;</span>: <span class="string">&quot;quorum&quot;</span>, <span class="comment">// 使用仲裁队列</span></span><br><span class="line">		&#125;,</span><br><span class="line">	)</span><br><span class="line">	<span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span></span> Publish(queueName <span class="type">string</span>, message any, headers amqp.Table) <span class="type">error</span> &#123;</span><br><span class="line">	body, err := json.Marshal(message)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;failed to marshal message: %w&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	msg := amqp.Publishing&#123;</span><br><span class="line">		DeliveryMode: amqp.Persistent,</span><br><span class="line">		ContentType:  <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">		Body:         body,</span><br><span class="line">		Headers:      headers,</span><br><span class="line">		Timestamp:    time.Now(),</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> r.channel.Publish(</span><br><span class="line">		<span class="string">&quot;&quot;</span>,         <span class="comment">// exchange</span></span><br><span class="line">		queueName,  <span class="comment">// routing key</span></span><br><span class="line">		<span class="literal">false</span>,      <span class="comment">// mandatory</span></span><br><span class="line">		<span class="literal">false</span>,      <span class="comment">// immediate</span></span><br><span class="line">		msg,</span><br><span class="line">	)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span></span> Consume(queueName <span class="type">string</span>, handler <span class="function"><span class="keyword">func</span><span class="params">([]<span class="type">byte</span>, amqp.Table)</span></span>) <span class="type">error</span> &#123;</span><br><span class="line">	msgs, err := r.channel.Consume(</span><br><span class="line">		queueName, <span class="comment">// queue</span></span><br><span class="line">		<span class="string">&quot;&quot;</span>,        <span class="comment">// consumer</span></span><br><span class="line">		<span class="literal">false</span>,     <span class="comment">// auto-ack</span></span><br><span class="line">		<span class="literal">false</span>,     <span class="comment">// exclusive</span></span><br><span class="line">		<span class="literal">false</span>,     <span class="comment">// no-local</span></span><br><span class="line">		<span class="literal">false</span>,     <span class="comment">// no-wait</span></span><br><span class="line">		<span class="literal">nil</span>,       <span class="comment">// args</span></span><br><span class="line">	)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;failed to register consumer: %w&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// QoS设置</span></span><br><span class="line">	<span class="keyword">if</span> err := r.channel.Qos(</span><br><span class="line">		<span class="number">1</span>,     <span class="comment">// prefetch count</span></span><br><span class="line">		<span class="number">0</span>,     <span class="comment">// prefetch size</span></span><br><span class="line">		<span class="literal">false</span>, <span class="comment">// global</span></span><br><span class="line">	); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;failed to set QoS: %w&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">for</span> d := <span class="keyword">range</span> msgs &#123;</span><br><span class="line">			handler(d.Body, d.Headers)</span><br><span class="line">			d.Ack(<span class="literal">false</span>) <span class="comment">// 手动确认</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span></span> Close() &#123;</span><br><span class="line">	<span class="keyword">if</span> r.channel != <span class="literal">nil</span> &#123;</span><br><span class="line">		r.channel.Close()</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> r.conn != <span class="literal">nil</span> &#123;</span><br><span class="line">		r.conn.Close()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 创建RabbitMQ连接</span></span><br><span class="line">	rabbit, err := NewRabbitMQ(<span class="string">&quot;amqp://guest:guest@localhost:5672/&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalf(<span class="string">&quot;Failed to create RabbitMQ client: %v&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> rabbit.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 声明队列</span></span><br><span class="line">	<span class="keyword">if</span> err := rabbit.DeclareQueue(<span class="string">&quot;go_queue&quot;</span>, <span class="literal">true</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalf(<span class="string">&quot;Failed to declare queue: %v&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 发布消息</span></span><br><span class="line">	headers := amqp.Table&#123;</span><br><span class="line">		<span class="string">&quot;priority&quot;</span>: <span class="type">int32</span>(<span class="number">2</span>),</span><br><span class="line">		<span class="string">&quot;language&quot;</span>: <span class="string">&quot;golang&quot;</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	message := Message&#123;</span><br><span class="line">		Event:     <span class="string">&quot;user_login&quot;</span>,</span><br><span class="line">		Data:      <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;john_doe&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.1.100&quot;</span>&#125;,</span><br><span class="line">		Timestamp: time.Now(),</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err := rabbit.Publish(<span class="string">&quot;go_queue&quot;</span>, message, headers); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Printf(<span class="string">&quot;Failed to publish message: %v&quot;</span>, err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		log.Println(<span class="string">&quot;Message published successfully&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 消费消息</span></span><br><span class="line">	handler := <span class="function"><span class="keyword">func</span><span class="params">(body []<span class="type">byte</span>, headers amqp.Table)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> msg Message</span><br><span class="line">		<span class="keyword">if</span> err := json.Unmarshal(body, &amp;msg); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			log.Printf(<span class="string">&quot;Failed to unmarshal message: %v&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		log.Printf(<span class="string">&quot;Received message: %+v&quot;</span>, msg)</span><br><span class="line">		log.Printf(<span class="string">&quot;Headers: %+v&quot;</span>, headers)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 模拟处理</span></span><br><span class="line">		time.Sleep(<span class="number">500</span> * time.Millisecond)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err := rabbit.Consume(<span class="string">&quot;go_queue&quot;</span>, handler); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalf(<span class="string">&quot;Failed to start consumer: %v&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 保持程序运行</span></span><br><span class="line">	<span class="keyword">select</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="七、总结与最佳实践"><a href="#七、总结与最佳实践" class="headerlink" title="七、总结与最佳实践"></a>七、总结与最佳实践</h2><h3 id="7-1-关键要点回顾"><a href="#7-1-关键要点回顾" class="headerlink" title="7.1 关键要点回顾"></a>7.1 关键要点回顾</h3><ol><li><strong>版本选择</strong>：生产环境推荐使用3.10.x LTS版本，平衡稳定性与新特性</li><li><strong>集群设计</strong>：3节点仲裁队列集群是生产环境的黄金标准</li><li><strong>监控体系</strong>：必须集成Prometheus + Grafana，监控关键指标</li><li><strong>消息可靠性</strong>：持久化 + 确认机制 + 死信队列构成完整可靠性保障</li><li><strong>性能平衡</strong>：根据业务场景选择合适的持久化策略和QoS配置</li></ol><h3 id="7-2-未来展望"><a href="#7-2-未来展望" class="headerlink" title="7.2 未来展望"></a>7.2 未来展望</h3><p>RabbitMQ 4.0版本即将到来，将带来：</p><ul><li>原生gRPC支持</li><li>更强大的流处理能力</li><li>云原生部署优化</li><li>更细粒度的权限控制</li></ul><h3 id="7-3-实践生产环境建议"><a href="#7-3-实践生产环境建议" class="headerlink" title="7.3 实践生产环境建议"></a>7.3 实践生产环境建议</h3><ul><li><strong>开发环境</strong>：使用Docker快速搭建，配置简化</li><li><strong>测试环境</strong>：模拟网络分区，验证集群恢复能力</li><li><strong>生产环境</strong>：<ul><li>启用TLS加密</li><li>配置详细的监控告警</li><li>定期备份配置和元数据</li><li>建立灰度发布流程</li></ul></li></ul><p>RabbitMQ作为成熟的消息队列解决方案，其价值不仅在于技术实现，更在于如何将其融入到整体架构设计中。</p><h2 id="RabbitMQ深度实践系列（续）：版本特性对比与生产环境选型指南"><a href="#RabbitMQ深度实践系列（续）：版本特性对比与生产环境选型指南" class="headerlink" title="RabbitMQ深度实践系列（续）：版本特性对比与生产环境选型指南"></a>RabbitMQ深度实践系列（续）：版本特性对比与生产环境选型指南</h2><blockquote><p><strong>接上篇</strong>：在上一篇文章中，我们详细探讨了RabbitMQ的单体部署、集群搭建以及多语言客户端实践。本文将继续深入，重点分析RabbitMQ各版本的核心特性差异，帮助读者在生产环境中做出明智的版本选择。</p></blockquote><h3 id="一、RabbitMQ版本演进：从3-8到3-12的技术变革"><a href="#一、RabbitMQ版本演进：从3-8到3-12的技术变革" class="headerlink" title="一、RabbitMQ版本演进：从3.8到3.12的技术变革"></a>一、RabbitMQ版本演进：从3.8到3.12的技术变革</h3><p>RabbitMQ作为最流行的消息队列中间件之一，其版本迭代始终围绕<strong>性能、可靠性、扩展性</strong>三大核心维度展开。理解各版本特性差异，是构建稳定消息系统的前提。</p><h4 id="1-1-核心版本技术路线图"><a href="#1-1-核心版本技术路线图" class="headerlink" title="1.1 核心版本技术路线图"></a>1.1 核心版本技术路线图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3.8.x (2019) → 3.9.x (2021) → 3.10.x LTS (2022) → 3.11.x (2023) → 3.12.x (2024+)</span><br><span class="line">    ↓               ↓               ↓               ↓               ↓</span><br><span class="line">镜像队列时代    Quorum队列普及   LTS稳定期     流式处理革命    架构重构期</span><br></pre></td></tr></table></figure><h4 id="1-2-各版本关键特性对比"><a href="#1-2-各版本关键特性对比" class="headerlink" title="1.2 各版本关键特性对比"></a>1.2 各版本关键特性对比</h4><h5 id="3-10-x-LTS版本：企业级稳定的黄金标准"><a href="#3-10-x-LTS版本：企业级稳定的黄金标准" class="headerlink" title="3.10.x LTS版本：企业级稳定的黄金标准"></a><strong>3.10.x LTS版本：企业级稳定的黄金标准</strong></h5><ul><li><strong>核心突破</strong>：Quorum队列性能优化，发布确认延迟降低40%</li><li><strong>架构改进</strong>：完全弃用经典镜像队列，推荐Quorum队列作为高可用标准方案</li><li><strong>稳定性</strong>：经过2年+生产环境验证，金融、电信行业广泛采用</li><li><strong>兼容性</strong>：支持Erlang 23.3，部署门槛较低</li><li><strong>监控能力</strong>：内置200+ Prometheus指标，支持细粒度性能分析</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3.10.x典型部署配置</span></span><br><span class="line">rabbitmq-server-3.10.8</span><br><span class="line">erlang-base-23.3.4.18</span><br><span class="line"><span class="comment"># 特性标志示例</span></span><br><span class="line">rabbitmqctl enable_feature_flag quorum_queue</span><br></pre></td></tr></table></figure><h5 id="3-11-x版本：流式处理的开创者"><a href="#3-11-x版本：流式处理的开创者" class="headerlink" title="3.11.x版本：流式处理的开创者"></a><strong>3.11.x版本：流式处理的开创者</strong></h5><ul><li><strong>革命性功能</strong>：”超级流”(Super Streams)实现水平扩展</li><li><strong>技术亮点</strong>：<ul><li>支持分区存储与消费，保持消息严格顺序</li><li>单节点吞吐量提升3倍，适合事件溯源场景</li><li>增强AMQP 1.0协议支持</li></ul></li><li><strong>重要限制</strong>：2024年7月24日后，3.11版本的Messages for RabbitMQ实例将移除访问权</li><li><strong>适用场景</strong>：实时数据分析、日志处理等流式业务</li></ul><h5 id="3-12-x版本：架构重构的性能怪兽"><a href="#3-12-x版本：架构重构的性能怪兽" class="headerlink" title="3.12.x版本：架构重构的性能怪兽"></a><strong>3.12.x版本：架构重构的性能怪兽</strong></h5><ul><li><strong>颠覆性变更</strong>：<ul><li><strong>所有经典队列默认启用懒惰模式</strong>，内存占用降低80%</li><li>经典队列自动升级至CQv2（Classic Queue v2），单节点支持10万+队列</li><li>性能飞跃：较3.9版本吞吐量提升40%，P99延迟降低60%</li></ul></li><li><strong>强制要求</strong>：<ul><li>Erlang 25+（最低要求），推荐26.1.x</li><li>必须启用3.11引入的所有特性标志</li><li>不再支持Erlang 24及以下版本</li></ul></li></ul><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% 3.12.x配置示例（/etc/rabbitmq/rabbitmq.conf）</span></span><br><span class="line">queue_type = quorum  # 默认队列类型</span><br><span class="line">lazy_queue_explicit_gc_run_operation_threshold = <span class="number">5000</span></span><br><span class="line">max_message_size = <span class="number">134217728</span>  # <span class="number">128</span>MB</span><br></pre></td></tr></table></figure><h3 id="二、生产环境版本选择：科学决策矩阵"><a href="#二、生产环境版本选择：科学决策矩阵" class="headerlink" title="二、生产环境版本选择：科学决策矩阵"></a>二、生产环境版本选择：科学决策矩阵</h3><h4 id="2-1-企业类型与版本匹配策略"><a href="#2-1-企业类型与版本匹配策略" class="headerlink" title="2.1 企业类型与版本匹配策略"></a>2.1 企业类型与版本匹配策略</h4><table><thead><tr><th>企业类型</th><th>推荐版本</th><th>关键考量因素</th><th>风险等级</th></tr></thead><tbody><tr><td><strong>金融&#x2F;政务</strong></td><td>3.10.8 LTS</td><td>合规性、稳定性、审计支持</td><td>⭐（极低）</td></tr><tr><td><strong>电商&#x2F;互联网</strong></td><td>3.10.8 LTS → 3.12.x（2026下半年）</td><td>性能、扩展性、技术前瞻性</td><td>⭐⭐⭐（中）</td></tr><tr><td><strong>AI&#x2F;大数据</strong></td><td>3.12.15+（测试验证后）</td><td>超高吞吐、流处理能力</td><td>⭐⭐⭐⭐（高）</td></tr><tr><td><strong>初创公司</strong></td><td>3.10.8 LTS</td><td>快速部署、社区支持、学习成本</td><td>⭐（极低）</td></tr></tbody></table><h4 id="2-2-版本选择决策树"><a href="#2-2-版本选择决策树" class="headerlink" title="2.2 版本选择决策树"></a>2.2 版本选择决策树</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">当前需求是什么？</span><br><span class="line">├── 需要绝对稳定性和长期支持？ → 选择3.10.8 LTS</span><br><span class="line">├── 需要流式处理能力？ </span><br><span class="line">│   ├── 可接受版本迭代风险？ → 选择3.12.x</span><br><span class="line">│   └── 需要生产验证？ → 等待2026下半年</span><br><span class="line">└── 队列规模超过1万？ </span><br><span class="line">    ├── 有Erlang 25+运维能力？ → 选择3.12.x</span><br><span class="line">    └── 否则？ → 3.10.8 + 集群分片方案</span><br></pre></td></tr></table></figure><h3 id="三、生产环境部署实践：3-10-8-LTS详细指南"><a href="#三、生产环境部署实践：3-10-8-LTS详细指南" class="headerlink" title="三、生产环境部署实践：3.10.8 LTS详细指南"></a>三、生产环境部署实践：3.10.8 LTS详细指南</h3><h4 id="3-1-为什么3-10-8是2026年生产环境最佳选择？"><a href="#3-1-为什么3-10-8是2026年生产环境最佳选择？" class="headerlink" title="3.1 为什么3.10.8是2026年生产环境最佳选择？"></a>3.1 为什么3.10.8是2026年生产环境最佳选择？</h4><ul><li><strong>LTS支持周期</strong>：官方承诺至少3年安全更新（至2027年）</li><li><strong>社区生态成熟</strong>：90%的第三方工具（监控、管理、客户端）完全兼容</li><li><strong>升级路径清晰</strong>：从3.8&#x2F;3.9升级到3.10.8的失败率&lt;0.5%</li><li><strong>性能足够</strong>：单节点可处理5万+消息&#x2F;秒，满足95%企业需求</li></ul><h4 id="3-2-高可用集群部署最佳实践"><a href="#3-2-高可用集群部署最佳实践" class="headerlink" title="3.2 高可用集群部署最佳实践"></a>3.2 高可用集群部署最佳实践</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基础环境准备（Ubuntu 22.04）</span></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y curl gnupg apt-transport-https</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加官方LTS仓库</span></span><br><span class="line">curl -1sLf <span class="string">&quot;https://keys.openpgp.org/vks/v1/by-fingerprint/0A9AF2115F4687BD29803A206B73A36E6026DFCA&quot;</span> | sudo gpg --dearmor -o /usr/share/keyrings/com.rabbitmq.team.gpg</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;deb [signed-by=/usr/share/keyrings/com.rabbitmq.team.gpg] https://github.com/rabbitmq/signing-keys/releases/download/2.0/rabbitmq-server-3.10.x-ubuntu-jammy.list&quot;</span> | sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/rabbitmq.list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装指定版本</span></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y erlang-base=1:23.3.4.18 rabbitmq-server=3.10.8-1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证安装</span></span><br><span class="line">rabbitmqctl status</span><br><span class="line"><span class="comment"># 应显示：RabbitMQ version: 3.10.8, Erlang version: 23.3.4.18</span></span><br></pre></td></tr></table></figure><h4 id="3-3-生产级配置优化"><a href="#3-3-生产级配置优化" class="headerlink" title="3.3 生产级配置优化"></a>3.3 生产级配置优化</h4><p><code>/etc/rabbitmq/rabbitmq.conf</code>:</p><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 基础配置</span><br><span class="line">listeners.tcp.default = <span class="number">5672</span></span><br><span class="line">management.listener.port = <span class="number">15672</span></span><br><span class="line">management.listener.ssl = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"># 内存与磁盘</span><br><span class="line">vm_memory_high_watermark.relative = <span class="number">0.6</span></span><br><span class="line">disk_free_limit.absolute = <span class="number">2</span>GB</span><br><span class="line"></span><br><span class="line"># 集群与高可用</span><br><span class="line">cluster_partition_handling = pause_minority</span><br><span class="line">mirroring_sync_batch_size = <span class="number">5000</span></span><br><span class="line"></span><br><span class="line"># Quorum队列优化</span><br><span class="line">quorum_commands_soft_limit = <span class="number">1000</span></span><br><span class="line">quorum_commands_hard_limit = <span class="number">2000</span></span><br><span class="line"></span><br><span class="line"># 性能调优</span><br><span class="line">channel_max = <span class="number">2047</span></span><br><span class="line">consumer_timeout = <span class="number">300000</span></span><br></pre></td></tr></table></figure><h3 id="四、版本升级策略：从3-10-x到3-12-x的演进路径"><a href="#四、版本升级策略：从3-10-x到3-12-x的演进路径" class="headerlink" title="四、版本升级策略：从3.10.x到3.12.x的演进路径"></a>四、版本升级策略：从3.10.x到3.12.x的演进路径</h3><h4 id="4-1-升级风险评估"><a href="#4-1-升级风险评估" class="headerlink" title="4.1 升级风险评估"></a>4.1 升级风险评估</h4><table><thead><tr><th>风险维度</th><th>3.10.x → 3.11.x</th><th>3.11.x → 3.12.x</th><th>3.10.x → 3.12.x</th></tr></thead><tbody><tr><td><strong>数据兼容性</strong></td><td>95%</td><td>90%</td><td>70%</td></tr><tr><td><strong>客户端兼容性</strong></td><td>98%</td><td>85%</td><td>60%</td></tr><tr><td><strong>性能影响</strong></td><td>+15%</td><td>+25%</td><td>+40%</td></tr><tr><td><strong>回滚难度</strong></td><td>简单</td><td>中等</td><td>复杂</td></tr></tbody></table><h4 id="4-2-安全升级步骤"><a href="#4-2-安全升级步骤" class="headerlink" title="4.2 安全升级步骤"></a>4.2 安全升级步骤</h4><p><strong>阶段1：特性标志预热（2026 Q3）</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在3.10.8集群上启用未来版本特性</span></span><br><span class="line">rabbitmqctl enable_feature_flag quorum_queue</span><br><span class="line">rabbitmqctl enable_feature_flag stream_queue</span><br><span class="line">rabbitmqctl enable_feature_flag classic_mirrored_queue_version</span><br></pre></td></tr></table></figure><p><strong>阶段2：灰度环境验证（2026 Q4）</strong></p><ul><li>在非生产环境部署3.12.15测试集群</li><li>模拟生产流量，监控72小时</li><li>验证客户端兼容性（特别关注PHP&#x2F;Python&#x2F;Go SDK）</li></ul><p><strong>阶段3：分批次升级（2027 Q1）</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">应用服务A → 消息队列集群1（3.12） → 应用服务B</span><br><span class="line">          ↓</span><br><span class="line">消息队列集群2（3.10 LTS） ← 应用服务C</span><br></pre></td></tr></table></figure><h3 id="五、多语言客户端版本兼容性指南"><a href="#五、多语言客户端版本兼容性指南" class="headerlink" title="五、多语言客户端版本兼容性指南"></a>五、多语言客户端版本兼容性指南</h3><h4 id="5-1-SDK版本矩阵"><a href="#5-1-SDK版本矩阵" class="headerlink" title="5.1 SDK版本矩阵"></a>5.1 SDK版本矩阵</h4><table><thead><tr><th>语言</th><th>RabbitMQ 3.10.x</th><th>RabbitMQ 3.12.x</th><th>推荐SDK版本</th></tr></thead><tbody><tr><td><strong>PHP</strong></td><td>php-amqplib 3.5+</td><td>需要3.7+</td><td>v3.6.1（兼容3.10&#x2F;3.12）</td></tr><tr><td><strong>Python</strong></td><td>pika 1.3+</td><td>需要1.4+</td><td>v1.3.2（稳定版）</td></tr><tr><td><strong>Golang</strong></td><td>streadway&#x2F;amqp v1.5+</td><td>需要v1.7+</td><td>v1.6.1（推荐）</td></tr></tbody></table><h4 id="5-2-PHP客户端兼容性示例"><a href="#5-2-PHP客户端兼容性示例" class="headerlink" title="5.2 PHP客户端兼容性示例"></a>5.2 PHP客户端兼容性示例</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 兼容3.10.x和3.12.x的连接配置</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RabbitMQConnectionFactory</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$version</span> = <span class="string">&#x27;3.10&#x27;</span></span>): <span class="title">AMQPStreamConnection</span> </span>&#123;</span><br><span class="line">        <span class="variable">$params</span> = [</span><br><span class="line">            <span class="string">&#x27;host&#x27;</span> =&gt; <span class="string">&#x27;rabbitmq-cluster&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;port&#x27;</span> =&gt; <span class="number">5672</span>,</span><br><span class="line">            <span class="string">&#x27;user&#x27;</span> =&gt; <span class="string">&#x27;app_user&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;secure_password&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;vhost&#x27;</span> =&gt; <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3.12.x需要特定参数</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$version</span> === <span class="string">&#x27;3.12&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;insist&#x27;</span>] = <span class="literal">false</span>;</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;login_method&#x27;</span>] = <span class="string">&#x27;PLAIN&#x27;</span>;</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;login_response&#x27;</span>] = <span class="literal">null</span>;</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;locale&#x27;</span>] = <span class="string">&#x27;en_US&#x27;</span>;</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;connection_timeout&#x27;</span>] = <span class="number">3.0</span>;</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;read_write_timeout&#x27;</span>] = <span class="number">6.0</span>; <span class="comment">// 3.12需要更长的超时</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AMQPStreamConnection</span>(</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;host&#x27;</span>],</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;port&#x27;</span>],</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;user&#x27;</span>],</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;password&#x27;</span>],</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;vhost&#x27;</span>],</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;insist&#x27;</span>] ?? <span class="literal">false</span>,</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;login_method&#x27;</span>] ?? <span class="string">&#x27;AMQPLAIN&#x27;</span>,</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;login_response&#x27;</span>] ?? <span class="literal">null</span>,</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;locale&#x27;</span>] ?? <span class="string">&#x27;en_US&#x27;</span>,</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;connection_timeout&#x27;</span>] ?? <span class="number">3.0</span>,</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;read_write_timeout&#x27;</span>] ?? <span class="number">3.0</span>,</span><br><span class="line">            <span class="literal">null</span>,</span><br><span class="line">            <span class="literal">null</span>,</span><br><span class="line">            <span class="string">&#x27;rabbitmq-client-php-compat&#x27;</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="六、总结与未来展望"><a href="#六、总结与未来展望" class="headerlink" title="六、总结与未来展望"></a>六、总结与未来展望</h3><h4 id="6-1-2026年生产环境最佳实践"><a href="#6-1-2026年生产环境最佳实践" class="headerlink" title="6.1 2026年生产环境最佳实践"></a>6.1 2026年生产环境最佳实践</h4><ul><li><strong>核心推荐</strong>：RabbitMQ 3.10.8 LTS + Erlang 23.3.4.18</li><li><strong>架构建议</strong>：3节点Quorum队列集群 + HAProxy负载均衡</li><li><strong>监控体系</strong>：Prometheus + Grafana + AlertManager三级监控</li><li><strong>备份策略</strong>：每日配置导出 + 每周元数据备份</li></ul><h4 id="6-2-技术演进路线"><a href="#6-2-技术演进路线" class="headerlink" title="6.2 技术演进路线"></a>6.2 技术演进路线</h4><ul><li><strong>2026下半年</strong>：3.12.x在互联网企业开始大规模应用</li><li><strong>2027年</strong>：RabbitMQ 4.0预计发布，引入原生gRPC支持</li><li><strong>2028年</strong>：云原生部署成为主流，Serverless消息队列兴起</li></ul><h4 id="6-3-关键建议和选型原则"><a href="#6-3-关键建议和选型原则" class="headerlink" title="6.3 关键建议和选型原则"></a>6.3 关键建议和选型原则</h4><blockquote><p><strong>“在消息队列领域，稳定性永远比新特性更重要。选择LTS版本不是保守，而是对业务负责。”</strong></p></blockquote><ul><li><strong>不要为了新特性而升级</strong>：除非业务有明确需求（如流处理）</li><li><strong>升级前必须验证</strong>：在隔离环境测试所有业务场景</li><li><strong>保留回滚能力</strong>：每次升级前备份mnesia目录和配置</li><li><strong>关注Erlang版本</strong>：Erlang版本比RabbitMQ版本更重要</li></ul><p>⚠️补充说明：最后时间截止2025年12月前版本为准，后续调整以官方更新标准为准。</p></div><div class="article-licensing box"><div class="licensing-title"><p>RabbitMQ深度实践解析：从单体到集群的完整指南与多语言实战</p><p><a href="https://www.wdft.com/835133f.html">https://www.wdft.com/835133f.html</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Jaco Liu</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2023-11-22</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2026-01-12</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/RabbitMQ/">RabbitMQ</a><a class="link-muted mr-2" rel="tag" href="/tags/nosql/">nosql</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=627845fc01dad800199bf3d4&amp;product=inline-share-buttons" defer></script></article></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/e324f38b.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">WDFT (Warped Discrete Fourier Transform)</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/e3ad55d6.html"><span class="level-item">PHP XHProf 性能分析工具安装和基本使用生成性能图(Graphviz)实践</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><script src="/js/mermaid.min.js"></script></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen order-3"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#前言"><span class="level-left"><span class="level-item">1</span><span class="level-item">前言</span></span></a></li><li><a class="level is-mobile" href="#一、RabbitMQ版本演进与核心特性"><span class="level-left"><span class="level-item">2</span><span class="level-item">一、RabbitMQ版本演进与核心特性</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-1-版本发展脉络"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">1.1 版本发展脉络</span></span></a></li><li><a class="level is-mobile" href="#1-2-3-10-x版本核心特性详解"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">1.2 3.10.x版本核心特性详解</span></span></a></li></ul></li><li><a class="level is-mobile" href="#实验环境基本要求"><span class="level-left"><span class="level-item">3</span><span class="level-item">实验环境基本要求</span></span></a></li><li><a class="level is-mobile" href="#二、RabbitMQ-CLI使用详解"><span class="level-left"><span class="level-item">4</span><span class="level-item">二、RabbitMQ CLI使用详解</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-基础命令集"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">2.1 基础命令集</span></span></a></li><li><a class="level is-mobile" href="#2-2-高级管理命令"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">2.2 高级管理命令</span></span></a></li><li><a class="level is-mobile" href="#2-3-实用技巧"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">2.3 实用技巧</span></span></a></li></ul></li><li><a class="level is-mobile" href="#三、RabbitMQ使用注意事项"><span class="level-left"><span class="level-item">5</span><span class="level-item">三、RabbitMQ使用注意事项</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-1-生产环境避坑指南"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">3.1 生产环境避坑指南</span></span></a></li><li><a class="level is-mobile" href="#3-2-性能优化建议"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">3.2 性能优化建议</span></span></a></li></ul></li><li><a class="level is-mobile" href="#四、单体RabbitMQ应用搭建"><span class="level-left"><span class="level-item">6</span><span class="level-item">四、单体RabbitMQ应用搭建</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-1-环境准备"><span class="level-left"><span class="level-item">6.1</span><span class="level-item">4.1 环境准备</span></span></a></li><li><a class="level is-mobile" href="#4-2-配置优化"><span class="level-left"><span class="level-item">6.2</span><span class="level-item">4.2 配置优化</span></span></a></li><li><a class="level is-mobile" href="#4-3-插件启用"><span class="level-left"><span class="level-item">6.3</span><span class="level-item">4.3 插件启用</span></span></a></li></ul></li><li><a class="level is-mobile" href="#五、RabbitMQ集群搭建实战"><span class="level-left"><span class="level-item">7</span><span class="level-item">五、RabbitMQ集群搭建实战</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#5-1-集群架构设计"><span class="level-left"><span class="level-item">7.1</span><span class="level-item">5.1 集群架构设计</span></span></a></li><li><a class="level is-mobile" href="#5-2-集群搭建步骤"><span class="level-left"><span class="level-item">7.2</span><span class="level-item">5.2 集群搭建步骤</span></span></a></li><li><a class="level is-mobile" href="#5-3-高可用队列配置"><span class="level-left"><span class="level-item">7.3</span><span class="level-item">5.3 高可用队列配置</span></span></a></li><li><a class="level is-mobile" href="#5-4-负载均衡配置"><span class="level-left"><span class="level-item">7.4</span><span class="level-item">5.4 负载均衡配置</span></span></a></li></ul></li><li><a class="level is-mobile" href="#六、多语言客户端实践"><span class="level-left"><span class="level-item">8</span><span class="level-item">六、多语言客户端实践</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#6-1-PHP调用示例"><span class="level-left"><span class="level-item">8.1</span><span class="level-item">6.1 PHP调用示例</span></span></a></li><li><a class="level is-mobile" href="#6-2-Python调用示例"><span class="level-left"><span class="level-item">8.2</span><span class="level-item">6.2 Python调用示例</span></span></a></li><li><a class="level is-mobile" href="#6-3-Go语言调用示例"><span class="level-left"><span class="level-item">8.3</span><span class="level-item">6.3 Go语言调用示例</span></span></a></li></ul></li><li><a class="level is-mobile" href="#七、总结与最佳实践"><span class="level-left"><span class="level-item">9</span><span class="level-item">七、总结与最佳实践</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#7-1-关键要点回顾"><span class="level-left"><span class="level-item">9.1</span><span class="level-item">7.1 关键要点回顾</span></span></a></li><li><a class="level is-mobile" href="#7-2-未来展望"><span class="level-left"><span class="level-item">9.2</span><span class="level-item">7.2 未来展望</span></span></a></li><li><a class="level is-mobile" href="#7-3-实践生产环境建议"><span class="level-left"><span class="level-item">9.3</span><span class="level-item">7.3 实践生产环境建议</span></span></a></li></ul></li><li><a class="level is-mobile" href="#RabbitMQ深度实践系列（续）：版本特性对比与生产环境选型指南"><span class="level-left"><span class="level-item">10</span><span class="level-item">RabbitMQ深度实践系列（续）：版本特性对比与生产环境选型指南</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#一、RabbitMQ版本演进：从3-8到3-12的技术变革"><span class="level-left"><span class="level-item">10.1</span><span class="level-item">一、RabbitMQ版本演进：从3.8到3.12的技术变革</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-1-核心版本技术路线图"><span class="level-left"><span class="level-item">10.1.1</span><span class="level-item">1.1 核心版本技术路线图</span></span></a></li><li><a class="level is-mobile" href="#1-2-各版本关键特性对比"><span class="level-left"><span class="level-item">10.1.2</span><span class="level-item">1.2 各版本关键特性对比</span></span></a></li></ul></li><li><a class="level is-mobile" href="#二、生产环境版本选择：科学决策矩阵"><span class="level-left"><span class="level-item">10.2</span><span class="level-item">二、生产环境版本选择：科学决策矩阵</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-企业类型与版本匹配策略"><span class="level-left"><span class="level-item">10.2.1</span><span class="level-item">2.1 企业类型与版本匹配策略</span></span></a></li><li><a class="level is-mobile" href="#2-2-版本选择决策树"><span class="level-left"><span class="level-item">10.2.2</span><span class="level-item">2.2 版本选择决策树</span></span></a></li></ul></li><li><a class="level is-mobile" href="#三、生产环境部署实践：3-10-8-LTS详细指南"><span class="level-left"><span class="level-item">10.3</span><span class="level-item">三、生产环境部署实践：3.10.8 LTS详细指南</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-1-为什么3-10-8是2026年生产环境最佳选择？"><span class="level-left"><span class="level-item">10.3.1</span><span class="level-item">3.1 为什么3.10.8是2026年生产环境最佳选择？</span></span></a></li><li><a class="level is-mobile" href="#3-2-高可用集群部署最佳实践"><span class="level-left"><span class="level-item">10.3.2</span><span class="level-item">3.2 高可用集群部署最佳实践</span></span></a></li><li><a class="level is-mobile" href="#3-3-生产级配置优化"><span class="level-left"><span class="level-item">10.3.3</span><span class="level-item">3.3 生产级配置优化</span></span></a></li></ul></li><li><a class="level is-mobile" href="#四、版本升级策略：从3-10-x到3-12-x的演进路径"><span class="level-left"><span class="level-item">10.4</span><span class="level-item">四、版本升级策略：从3.10.x到3.12.x的演进路径</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-1-升级风险评估"><span class="level-left"><span class="level-item">10.4.1</span><span class="level-item">4.1 升级风险评估</span></span></a></li><li><a class="level is-mobile" href="#4-2-安全升级步骤"><span class="level-left"><span class="level-item">10.4.2</span><span class="level-item">4.2 安全升级步骤</span></span></a></li></ul></li><li><a class="level is-mobile" href="#五、多语言客户端版本兼容性指南"><span class="level-left"><span class="level-item">10.5</span><span class="level-item">五、多语言客户端版本兼容性指南</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#5-1-SDK版本矩阵"><span class="level-left"><span class="level-item">10.5.1</span><span class="level-item">5.1 SDK版本矩阵</span></span></a></li><li><a class="level is-mobile" href="#5-2-PHP客户端兼容性示例"><span class="level-left"><span class="level-item">10.5.2</span><span class="level-item">5.2 PHP客户端兼容性示例</span></span></a></li></ul></li><li><a class="level is-mobile" href="#六、总结与未来展望"><span class="level-left"><span class="level-item">10.6</span><span class="level-item">六、总结与未来展望</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#6-1-2026年生产环境最佳实践"><span class="level-left"><span class="level-item">10.6.1</span><span class="level-item">6.1 2026年生产环境最佳实践</span></span></a></li><li><a class="level is-mobile" href="#6-2-技术演进路线"><span class="level-left"><span class="level-item">10.6.2</span><span class="level-item">6.2 技术演进路线</span></span></a></li><li><a class="level is-mobile" href="#6-3-关键建议和选型原则"><span class="level-left"><span class="level-item">10.6.3</span><span class="level-item">6.3 关键建议和选型原则</span></span></a></li></ul></li></ul></li></ul></div></div><style>#toc .menu-list>li>a.is-active+.menu-list{display:block}#toc .menu-list>li>a+.menu-list{display:none}</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/8bbd939d.html"><img src="/assets/images/php01.jpg" alt="PHP关键版本演进史：从7.4到8.4的完整变迁、注意事项解析"></a></figure><div class="media-content"><p class="date"><time datetime="2026-01-07T15:13:57.000Z">2026-01-07</time></p><p class="title"><a href="/8bbd939d.html">PHP关键版本演进史：从7.4到8.4的完整变迁、注意事项解析</a></p><p class="categories"><a href="/categories/php/">php</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/5e9a274.html"><img src="/assets/images/javascript01.jpg" alt="JavaScript ES5到ES16版本演进凝思：语法特性差异对比详解（含完整发布时间线梳理）"></a></figure><div class="media-content"><p class="date"><time datetime="2025-12-30T15:17:39.000Z">2025-12-30</time></p><p class="title"><a href="/5e9a274.html">JavaScript ES5到ES16版本演进凝思：语法特性差异对比详解（含完整发布时间线梳理）</a></p><p class="categories"><a href="/categories/javascript/">javascript</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/4adbc11a.html"><img src="/assets/images/ai-logo.png" alt="Discussion and analysis of Text2SQL technology, the most difficult pain point in the commercial implementation of agents.（Agent 商业落地里最难的痛点 Text2SQL 技术探讨和解析）"></a></figure><div class="media-content"><p class="date"><time datetime="2025-12-03T14:29:12.000Z">2025-12-03</time></p><p class="title"><a href="/4adbc11a.html">Discussion and analysis of Text2SQL technology, the most difficult pain point in the commercial implementation of agents.（Agent 商业落地里最难的痛点 Text2SQL 技术探讨和解析）</a></p><p class="categories"><a href="/categories/AI/">AI</a> / <a href="/categories/AI/Agent/">Agent</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/225323a0.html"><img src="/assets/images/ai-logo.png" alt="Ultimate Guide to Quantizing AI Large Language Models: From FP32 to INT4, How to Make Large Models Perform at Full Speed on Consumer Devices?（AI 大语言模型量化终极指南：从 FP32 到 INT4，如何让大模型在消费级设备部署应用及选型？）"></a></figure><div class="media-content"><p class="date"><time datetime="2025-12-02T14:29:13.000Z">2025-12-02</time></p><p class="title"><a href="/225323a0.html">Ultimate Guide to Quantizing AI Large Language Models: From FP32 to INT4, How to Make Large Models Perform at Full Speed on Consumer Devices?（AI 大语言模型量化终极指南：从 FP32 到 INT4，如何让大模型在消费级设备部署应用及选型？）</a></p><p class="categories"><a href="/categories/AI/">AI</a> / <a href="/categories/AI/Agent/">Agent</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/edd96fdf.html"><img src="/assets/images/ai-logo.png" alt="基于 Golang 模拟实现一个简化的 DeepSeek AI 模型 GRPO 算法推理"></a></figure><div class="media-content"><p class="date"><time datetime="2025-12-01T14:12:43.000Z">2025-12-01</time></p><p class="title"><a href="/edd96fdf.html">基于 Golang 模拟实现一个简化的 DeepSeek AI 模型 GRPO 算法推理</a></p><p class="categories"><a href="/categories/AI/">AI</a> / <a href="/categories/AI/Algo/">Algo</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AI/"><span class="level-start"><span class="level-item">AI</span></span><span class="level-end"><span class="level-item tag">8</span></span></a><ul><li><a class="level is-mobile" href="/categories/AI/AIGC/"><span class="level-start"><span class="level-item">AIGC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/AI/Agent/"><span class="level-start"><span class="level-item">Agent</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/AI/Algo/"><span class="level-start"><span class="level-item">Algo</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/GIT/"><span class="level-start"><span class="level-item">GIT</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Go/"><span class="level-start"><span class="level-item">Go</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile" href="/categories/architecture/"><span class="level-start"><span class="level-item">architecture</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/clang/"><span class="level-start"><span class="level-item">clang</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/cloud/"><span class="level-start"><span class="level-item">cloud</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/daily/"><span class="level-start"><span class="level-item">daily</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/daily/note/"><span class="level-start"><span class="level-item">note</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/java/"><span class="level-start"><span class="level-item">java</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/javascript/"><span class="level-start"><span class="level-item">javascript</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/linux/"><span class="level-start"><span class="level-item">linux</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/linux/centos/"><span class="level-start"><span class="level-item">centos</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/linux/debian/"><span class="level-start"><span class="level-item">debian</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/linux/tools/"><span class="level-start"><span class="level-item">tools</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/lua/"><span class="level-start"><span class="level-item">lua</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/macOS/"><span class="level-start"><span class="level-item">macOS</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/nosql/"><span class="level-start"><span class="level-item">nosql</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/php/"><span class="level-start"><span class="level-item">php</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/python/"><span class="level-start"><span class="level-item">python</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/reprinted-articles/"><span class="level-start"><span class="level-item">reprinted-articles</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AIGC/"><span class="tag">AIGC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Agent/"><span class="tag">Agent</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Agent-Skill/"><span class="tag">Agent-Skill</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Agent-framework/"><span class="tag">Agent-framework</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Algorithm/"><span class="tag">Algorithm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CDN/"><span class="tag">CDN</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cloud-Distributed/"><span class="tag">Cloud-Distributed</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cloud-Native/"><span class="tag">Cloud-Native</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cloud-Native-Framework/"><span class="tag">Cloud-Native-Framework</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Controlnet/"><span class="tag">Controlnet</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DDD/"><span class="tag">DDD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DeepSeek/"><span class="tag">DeepSeek</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Distributed-Systems/"><span class="tag">Distributed-Systems</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Drawing/"><span class="tag">Drawing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ES/"><span class="tag">ES</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Elastic/"><span class="tag">Elastic</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ElasticSearch/"><span class="tag">ElasticSearch</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Framework/"><span class="tag">Framework</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GGUF/"><span class="tag">GGUF</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GIT/"><span class="tag">GIT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GO-%E6%96%B9%E6%B3%95%E5%80%BC/"><span class="tag">GO 方法值</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GPG/"><span class="tag">GPG</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GPG2/"><span class="tag">GPG2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GRPO/"><span class="tag">GRPO</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GUI/"><span class="tag">GUI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ghostty/"><span class="tag">Ghostty</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go/"><span class="tag">Go</span><span class="tag">27</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-Summary-notes/"><span class="tag">Go Summary notes</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-null-judge/"><span class="tag">Go null judge</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-Struct-Method-Receiver/"><span class="tag">Go(Struct|Method|Receiver)</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-map/"><span class="tag">Go(map)</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-new-make-struct/"><span class="tag">Go(new,make,struct{})</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-string/"><span class="tag">Go(string)</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-Polymorphism/"><span class="tag">Go-Polymorphism</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-Printf/"><span class="tag">Go-Printf</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-chain-operation/"><span class="tag">Go-chain-operation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-init/"><span class="tag">Go-init()</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Golang/"><span class="tag">Golang</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Google/"><span class="tag">Google</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/History/"><span class="tag">History</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Infra/"><span class="tag">Infra</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JS/"><span class="tag">JS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JSON/"><span class="tag">JSON</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java17/"><span class="tag">Java17</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java8/"><span class="tag">Java8</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/K3S-Build/"><span class="tag">K3S-Build</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/K8S/"><span class="tag">K8S</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/K8S-Build/"><span class="tag">K8S-Build</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kafka/"><span class="tag">Kafka</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Microservices/"><span class="tag">Microservices</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Movie/"><span class="tag">Movie</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Note-The-Legend-of-1900/"><span class="tag">Note The Legend of 1900</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OpenSSH/"><span class="tag">OpenSSH</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Qwen/"><span class="tag">Qwen</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RabbitMQ/"><span class="tag">RabbitMQ</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SD/"><span class="tag">SD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Skill/"><span class="tag">Skill</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Syntax/"><span class="tag">Syntax</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TS/"><span class="tag">TS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Text2SQL/"><span class="tag">Text2SQL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TypeScript/"><span class="tag">TypeScript</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VIM/"><span class="tag">VIM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VIM-Author/"><span class="tag">VIM Author</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/XHProf/"><span class="tag">XHProf</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ansi-lib/"><span class="tag">ansi-lib</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/banner/"><span class="tag">banner</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/centos7/"><span class="tag">centos7</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/changelog/"><span class="tag">changelog</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/chattr/"><span class="tag">chattr</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clang/"><span class="tag">clang</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cli/"><span class="tag">cli</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/daily/"><span class="tag">daily</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/debian/"><span class="tag">debian</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/deepseek/"><span class="tag">deepseek</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firewalld/"><span class="tag">firewalld</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/format/"><span class="tag">format</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/func/"><span class="tag">func</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/go-pprof/"><span class="tag">go-pprof</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/goroutine/"><span class="tag">goroutine</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/history/"><span class="tag">history</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/history-of-programing/"><span class="tag">history-of-programing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/homebrew/"><span class="tag">homebrew</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/interface/"><span class="tag">interface</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/io/"><span class="tag">io</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kebernetes/"><span class="tag">kebernetes</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/laravel/"><span class="tag">laravel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/laravel-artisan/"><span class="tag">laravel-artisan</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/lua/"><span class="tag">lua</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macro/"><span class="tag">macro</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/motd/"><span class="tag">motd</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql/"><span class="tag">mysql</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql8-0/"><span class="tag">mysql8.0</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql8-x/"><span class="tag">mysql8.x</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nanochat/"><span class="tag">nanochat</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nanochat-zh-CN/"><span class="tag">nanochat-zh_CN</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/neofetch/"><span class="tag">neofetch</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nginx/"><span class="tag">nginx</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nosql/"><span class="tag">nosql</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/oh-my-zsh/"><span class="tag">oh-my-zsh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/omz/"><span class="tag">omz</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/openssl/"><span class="tag">openssl</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/package-time/"><span class="tag">package time</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/painting/"><span class="tag">painting</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/php/"><span class="tag">php</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pointer/"><span class="tag">pointer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postgresql/"><span class="tag">postgresql</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postgressql-engine/"><span class="tag">postgressql-engine</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reflect-%E5%8F%8D%E5%B0%84/"><span class="tag">reflect 反射</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rocky/"><span class="tag">rocky</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rocky-linux/"><span class="tag">rocky-linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rocky-linux-tools/"><span class="tag">rocky-linux-tools</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rsync/"><span class="tag">rsync</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rune/"><span class="tag">rune</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/services/"><span class="tag">services</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/slice-%E5%88%87%E7%89%87%E6%9C%AC%E8%B4%A8/"><span class="tag">slice 切片本质</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/stable-diffusion-webui/"><span class="tag">stable-diffusion-webui</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/struct/"><span class="tag">struct</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/switch/"><span class="tag">switch</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/systemd-service/"><span class="tag">systemd-service</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/terminal/"><span class="tag">terminal</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/travel/"><span class="tag">travel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/type/"><span class="tag">type</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/type-%E5%85%B3%E9%94%AE%E8%AF%8D%E6%80%BB%E7%BB%93/"><span class="tag">type 关键词总结</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/utf8mb4/"><span class="tag">utf8mb4</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/utf8mb4-0900-ai-ci/"><span class="tag">utf8mb4_0900_ai_ci</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/utf8mb4-general-ci/"><span class="tag">utf8mb4_general_ci</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/zsh/"><span class="tag">zsh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%BA%E7%94%9F/"><span class="tag">人生</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%97%A5%E5%B8%B8/"><span class="tag">日常</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%9F%E6%B4%BB/"><span class="tag">生活</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%BD%AC%E8%BD%BD/"><span class="tag">转载</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BD%93%E7%B3%BB/"><span class="tag">配置文件体系</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%98%B2%E7%81%AB%E5%A2%99/"><span class="tag">防火墙</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="clustrmaps"><div class="card-content"><div class="menu"><h3 class="menu-label">CLUSTRMAPS</h3></div><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div style="margin-top:10px"><script type="text/javascript" id="clustrmaps" src="https://cdn.clustrmaps.com/map_v2.js?cl=ffffff&amp;w=250&amp;t=n&amp;d=xb7wV_PHYtl9KaSZpQgP9CLUNrXlqm480vcarJmX2A0&amp;co=2d78ad&amp;cmo=3acc3a&amp;cmn=ff5353&amp;ct=ffffff"></script><script type="text/javascript" id="clstr_globe" src="https://clustrmaps.com/globe.js?d=xb7wV_PHYtl9KaSZpQgP9CLUNrXlqm480vcarJmX2A0"></script></div></div></nav></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8952360410310192" data-ad-slot="1345698037" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></div></div></div></section><footer class="footer" style="padding:1rem 1.5rem 0"><div class="container"><div class="level"><div class="level-start"><p class="is-size-7"><a class="footer-logo" style="margin-right:10px" href="/"><img src="/img/logo.svg" alt="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节." height="16" style="max-height:1.25rem"></a><a href="http://beian.miit.gov.cn" target="_blank">鲁ICP备2023051700号</a>  <span>&copy; 2026 Jaco Liu</span>  <span style="color:#e0e0e0">Powered by <a style="color:#e0e0e0" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a style="color:#e0e0e0" href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>  <span id="busuanzi_container_site_pv">Total Visits Counts: <span id="busuanzi_value_site_pv"></span>.</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Jaco Liu&#039;GitHub" href="https://github.com/ljq"><i class="fab fa-github"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="ref.wdft.com" href="https://ref.wdft.com"><i class="fas fa-cloud"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="cook.wdft.com" href="https://cook.wdft.com"><i class="fas fa-coffee"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Python PEP8" href="https://pep8.org"><i class="fas fa-coffee"></i></a></p> <span><i class="fas fa-link">BlogRoll:</i></span><p class="control" style="color:#26c1fa"><a class="button is-transparent" target="_blank" rel="noopener" title="Quick Reference" href="https://ref.wdft.com">Quick Reference</a></p><p class="control" style="color:#26c1fa"><a class="button is-transparent" target="_blank" rel="noopener" title="Cook" href="https://cook.wdft.com">Cook</a></p><p class="control" style="color:#26c1fa"><a class="button is-transparent" target="_blank" rel="noopener" title="koala-oss.app" href="https://koala-oss.app/news/">koala-oss.app</a></p><p class="control" style="color:#26c1fa"><a class="button is-transparent" target="_blank" rel="noopener" title="CS自学指南" href="https://csdiy.wiki">CS自学指南</a></p><p class="control" style="color:#26c1fa"><a class="button is-transparent" target="_blank" rel="noopener" title="Python PEP8" href="https://pep8.org">Python PEP8</a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("en")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="/js/switchDarkMode.js" defer></script><script src="/js/toutiaoSEO.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load",()=>{window.cookieconsent.initialise({type:"info",theme:"edgeless",static:!1,position:"bottom-left",content:{message:"This website uses cookies to improve your experience.",dismiss:"Got it!",allow:"Allow cookies",deny:"Decline",link:"Learn more",policy:"Cookie Policy",href:"https://www.cookiesandyou.com/"},palette:{popup:{background:"#edeff5",text:"#838391"},button:{background:"#4b81e8"}}})})</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load",()=>{"function"==typeof $.fn.lightGallery&&$(".article").lightGallery({selector:".gallery-item"}),"function"==typeof $.fn.justifiedGallery&&($(".justified-gallery > p > .gallery-item").length&&$(".justified-gallery > p > .gallery-item").unwrap(),$(".justified-gallery").justifiedGallery())})</script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",function(){loadInsight({contentUrl:"/content.json"},{hint:"Type something...",untitled:"(Untitled)",posts:"Posts",pages:"Pages",categories:"Categories",tags:"Tags"})})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/hijiki.model.json"},display:{position:"right",width:150,height:300},mobile:{show:!0},react:{opacity:.7},pluginJsPath:"lib/",pluginRootPath:"live2dw/"})</script></body></html>