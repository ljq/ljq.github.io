<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta><title>Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节.</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节."><meta name="msapplication-TileImage" content="/img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节."><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Jaco Liu Personal Site.https:&amp;#x2F;&amp;#x2F;github.com&amp;#x2F;ljq"><meta property="og:type" content="blog"><meta property="og:title" content="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节."><meta property="og:url" content="https://www.wdft.com/"><meta property="og:site_name" content="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节."><meta property="og:description" content="Jaco Liu Personal Site.https:&amp;#x2F;&amp;#x2F;github.com&amp;#x2F;ljq"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://www.wdft.com/img/og_image.png"><meta property="article:author" content="Jaco Liu"><meta property="article:tag" content="Jaco Liu Blogger,IT,it,program,coding,GitHub(ljq@GitHub),Golang,Linux"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.wdft.com"},"headline":"Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节.","image":["https://www.wdft.com/img/og_image.png"],"author":{"@type":"Person","name":"Jaco Liu"},"publisher":{"@type":"Organization","name":"Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节.","logo":{"@type":"ImageObject","url":"https://www.wdft.com/img/logo.svg"}},"description":"Jaco Liu Personal Site.https:&#x2F;&#x2F;github.com&#x2F;ljq"}</script><link rel="alternate" href="/atom.xml" title="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节." type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.15.2/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="//hm.baidu.com/hm.js?45914c5ebb523a9ed07ab35e4dc81374",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><meta name="msvalidate.01" content="ad0df3c8d20f49daaeb5baa3c9dbfe75"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8952360410310192" crossorigin="anonymous"></script><script>!function(){function e(){if(location.hash){Array.from(document.querySelectorAll(".tab-content")).forEach(e=>{e.classList.add("is-hidden")}),Array.from(document.querySelectorAll(".tabs li")).forEach(e=>{e.classList.remove("is-active")});const e=document.querySelector(location.hash),t=(e&&e.classList.remove("is-hidden"),document.querySelector(`a[href="${location.hash}"]`));t&&t.parentElement.classList.add("is-active")}}e(),window.addEventListener("hashchange",e,!1)}()</script><meta name="generator" content="Hexo 6.1.0"></head><body class="is-3-column"><img src="/img/avatar.jpeg" width="0" height="0"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节." height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/musics">Musics</a><a class="navbar-item" href="/videos">Videos</a><a class="navbar-item" href="/galleries">Galleries</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item dark-mode-btn" title="Light|Dark" rel="noopener" onclick="switchDarkMode()">    <i class="fas fa-lightbulb">  </i></a><a class="navbar-item" target="_blank" rel="noopener" title="Musics" href="/musics"><i class="fas fa-music"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Videos" href="/videos"><i class="fas fa-video"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="WeChat Account (labsec)" href="/assets/images/about/ljq-qrcode.jpeg"><i class="fab fa-weixin"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Jaco Liu GitHub" href="https://github.com/ljq"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-image"><a class="image is-7by3" href="/65d4601b.html"><img class="fill" src="/assets/images/ai-logo.png" alt="Agent 与 Skills 之间的区别通过一个简单图书馆借阅系统案例实践指南"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2026-01-24T13:25:24.000Z" title="1/24/2026, 9:25:24 PM">2026-01-24</time></span><span class="level-item">Updated&nbsp;<time datetime="2026-01-24T13:39:35.597Z" title="1/24/2026, 9:39:35 PM">2026-01-24</time></span><span class="level-item"> Jaco Liu </span><span class="level-item"><a class="link-muted" href="/categories/AI/">AI</a><span> / </span><a class="link-muted" href="/categories/AI/Agent/">Agent</a></span><span class="level-item">an hour read (About 7191 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/65d4601b.html">Agent 与 Skills 之间的区别通过一个简单图书馆借阅系统案例实践指南</a></h1><div class="content"><h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>在技术语境下，两者的关系可以简单概括和区分为：Agent 是决策中心，Skills 是执行函数。</p><ul><li><p><strong>Agent (智能体)</strong>: 一个具备推理（Reasoning）、规划（Planning）和记忆（Memory）能力的实体。它通过 ReAct（Reasoning and Acting）框架决定何时调用哪个 Skill。</p></li><li><p><strong>Skills (技能&#x2F;工具)</strong>: 预定义的、具有明确输入&#x2F;输出模式的原子化功能（API、数据库查询、本地脚本等）。</p></li></ul><p>在人工智能技术快速发展的今天，Agent（智能代理）与 Skills（技能）的关系架构已成为构建复杂AI应用的核心范式。<br>LangChain作为当前最流行的开源框架，提供了预构建的agent架构和丰富的工具集成，让开发者能够快速构建适应性强的AI代理系统。<br>本文将深入探讨Agent与Skills的关系架构，基于Debian 12系统环境，从基础原理到实战部署一个图书馆借阅系统的简单案例来加深理解，提供完整的技术入门指南。</p><h2 id="一、Agent与Skills架构演进史"><a href="#一、Agent与Skills架构演进史" class="headerlink" title="一、Agent与Skills架构演进史"></a>一、Agent与Skills架构演进史</h2><h3 id="1-1-概念起源与版本演进"><a href="#1-1-概念起源与版本演进" class="headerlink" title="1.1 概念起源与版本演进"></a>1.1 概念起源与版本演进</h3><p>Agent-Skills架构的发展经历了多个重要阶段：</p><ul><li><strong>2020-2021年</strong>：早期概念阶段，主要关注基础LLM集成</li><li><strong>2022年</strong>：LangChain 0.0.1发布，首次提出Agent-Tools架构</li><li><strong>2023年</strong>：LangChain 0.1.0正式版，Skills概念正式确立</li><li><strong>2024年</strong>：LangChain 0.2.0，引入分层Skills管理和动态加载机制</li><li><strong>2025年</strong>：当前版本0.3.0，支持多模态Skills和分布式Agent协同</li></ul><h3 id="1-2-关键特性演变"><a href="#1-2-关键特性演变" class="headerlink" title="1.2 关键特性演变"></a>1.2 关键特性演变</h3><p><strong>v0.1.x 特性</strong>：</p><ul><li>基础Agent执行框架</li><li>简单Tools集成</li><li>串行任务处理</li></ul><p><strong>v0.2.x 特性</strong>：</p><ul><li>Skills模块化设计</li><li>动态技能加载</li><li>记忆管理优化</li><li>支持LangGraph工作流</li></ul><p><strong>v0.3.x 特性（当前）</strong>：</p><ul><li>多Agent协同架构</li><li>技能市场（Skills Marketplace）</li><li>实时性能监控</li><li>安全沙箱机制</li><li>跨语言Skills支持</li></ul><h2 id="二、Debian-12环境搭建与原理剖析"><a href="#二、Debian-12环境搭建与原理剖析" class="headerlink" title="二、Debian 12环境搭建与原理剖析"></a>二、Debian 12环境搭建与原理剖析</h2><h3 id="2-1-系统环境准备"><a href="#2-1-系统环境准备" class="headerlink" title="2.1 系统环境准备"></a>2.1 系统环境准备</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更新系统源</span></span><br><span class="line">sudo apt update &amp;&amp; sudo apt upgrade -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装基础依赖</span></span><br><span class="line">sudo apt install -y python3 python3-pip python3-venv git curl wget \</span><br><span class="line">    build-essential libpq-dev libssl-dev postgresql-client</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建项目目录</span></span><br><span class="line"><span class="built_in">mkdir</span> ~/agent-skills-project &amp;&amp; <span class="built_in">cd</span> ~/agent-skills-project</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建虚拟环境</span></span><br><span class="line">python3 -m venv venv</span><br><span class="line"><span class="built_in">source</span> venv/bin/activate</span><br></pre></td></tr></table></figure><h3 id="2-2-核心架构原理"><a href="#2-2-核心架构原理" class="headerlink" title="2.2 核心架构原理"></a>2.2 核心架构原理</h3><p>Agent与Skills的关系架构基于<strong>分层设计模式</strong>，包含三个核心层次：</p><ol><li><strong>Agent层</strong>：负责决策制定、任务规划和协调</li><li><strong>Skills层</strong>：提供具体功能实现，封装业务逻辑</li><li><strong>Integration层</strong>：连接外部系统和数据源</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 架构示意图</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Agent</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, skills_registry</span>):</span><br><span class="line">        self.skills = skills_registry  <span class="comment"># 技能注册中心</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">execute_task</span>(<span class="params">self, task</span>):</span><br><span class="line">        <span class="comment"># 1. 任务分析</span></span><br><span class="line">        skill_needed = self.analyze_task(task)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 2. 技能选择</span></span><br><span class="line">        selected_skill = self.select_skill(skill_needed)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 3. 技能执行</span></span><br><span class="line">        result = selected_skill.execute(task)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 4. 结果处理</span></span><br><span class="line">        <span class="keyword">return</span> self.process_result(result)</span><br></pre></td></tr></table></figure><h3 id="2-3-关键特性详解"><a href="#2-3-关键特性详解" class="headerlink" title="2.3 关键特性详解"></a>2.3 关键特性详解</h3><h4 id="2-3-1-动态技能加载"><a href="#2-3-1-动态技能加载" class="headerlink" title="2.3.1 动态技能加载"></a>2.3.1 动态技能加载</h4><p>Skills可以在运行时动态加载和卸载，无需重启Agent服务，极大提升了系统的灵活性和可维护性。</p><h4 id="2-3-2-技能组合机制"><a href="#2-3-2-技能组合机制" class="headerlink" title="2.3.2 技能组合机制"></a>2.3.2 技能组合机制</h4><p>多个Skills可以组合形成复合技能，支持复杂的业务场景处理。</p><h4 id="2-3-3-记忆管理"><a href="#2-3-3-记忆管理" class="headerlink" title="2.3.3 记忆管理"></a>2.3.3 记忆管理</h4><p>内置的对话记忆和上下文管理机制，确保Skills在执行过程中能够保持状态连续性。</p><h2 id="三、详细配置指南（带中文注释）"><a href="#三、详细配置指南（带中文注释）" class="headerlink" title="三、详细配置指南（带中文注释）"></a>三、详细配置指南（带中文注释）</h2><h3 id="3-1-核心配置文件-agent-config-yaml"><a href="#3-1-核心配置文件-agent-config-yaml" class="headerlink" title="3.1 核心配置文件 agent_config.yaml"></a>3.1 核心配置文件 <code>agent_config.yaml</code></h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Agent核心配置文件</span></span><br><span class="line"><span class="attr">agent:</span></span><br><span class="line">  <span class="comment"># Agent唯一标识符</span></span><br><span class="line">  <span class="attr">id:</span> <span class="string">&quot;library_management_agent&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Agent名称（显示用）</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">&quot;图书馆管理智能代理&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Agent描述信息</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">&quot;负责图书馆借阅、归还、查询等核心业务的智能代理&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># LLM模型配置</span></span><br><span class="line">  <span class="attr">llm:</span></span><br><span class="line">    <span class="comment"># 模型提供商（openai, anthropic, local等）</span></span><br><span class="line">    <span class="attr">provider:</span> <span class="string">&quot;openai&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 具体模型名称</span></span><br><span class="line">    <span class="attr">model_name:</span> <span class="string">&quot;gpt-4-turbo&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># API密钥（环境变量引用）</span></span><br><span class="line">    <span class="attr">api_key:</span> <span class="string">&quot;$&#123;OPENAI_API_KEY&#125;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 温度参数（控制随机性，0-1）</span></span><br><span class="line">    <span class="attr">temperature:</span> <span class="number">0.3</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 最大token数限制</span></span><br><span class="line">    <span class="attr">max_tokens:</span> <span class="number">2000</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 记忆管理配置</span></span><br><span class="line">  <span class="attr">memory:</span></span><br><span class="line">    <span class="comment"># 记忆类型（conversation, vector, hybrid）</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;hybrid&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 对话历史保存条数</span></span><br><span class="line">    <span class="attr">history_size:</span> <span class="number">10</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 向量存储配置</span></span><br><span class="line">    <span class="attr">vector_store:</span></span><br><span class="line">      <span class="comment"># 向量数据库类型</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">&quot;chroma&quot;</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment"># 持久化路径</span></span><br><span class="line">      <span class="attr">persist_path:</span> <span class="string">&quot;./data/vector_store&quot;</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment"># 嵌入模型</span></span><br><span class="line">      <span class="attr">embedding_model:</span> <span class="string">&quot;text-embedding-ada-002&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 技能注册中心配置</span></span><br><span class="line">  <span class="attr">skills_registry:</span></span><br><span class="line">    <span class="comment"># 技能目录路径</span></span><br><span class="line">    <span class="attr">skills_dir:</span> <span class="string">&quot;./skills&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 自动加载新技能</span></span><br><span class="line">    <span class="attr">auto_load:</span> <span class="literal">true</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 技能缓存时间（分钟）</span></span><br><span class="line">    <span class="attr">cache_ttl:</span> <span class="number">30</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 技能执行超时时间（秒）</span></span><br><span class="line">    <span class="attr">execution_timeout:</span> <span class="number">60</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 安全配置</span></span><br><span class="line">  <span class="attr">security:</span></span><br><span class="line">    <span class="comment"># 沙箱模式（true/false）</span></span><br><span class="line">    <span class="attr">sandbox_mode:</span> <span class="literal">true</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 允许的外部调用域名</span></span><br><span class="line">    <span class="attr">allowed_domains:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;localhost&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;postgres&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 技能权限控制</span></span><br><span class="line">    <span class="attr">skill_permissions:</span></span><br><span class="line">      <span class="comment"># 读取权限</span></span><br><span class="line">      <span class="attr">read:</span> [<span class="string">&quot;query_book&quot;</span>, <span class="string">&quot;check_availability&quot;</span>]</span><br><span class="line">      <span class="comment"># 写入权限</span></span><br><span class="line">      <span class="attr">write:</span> [<span class="string">&quot;borrow_book&quot;</span>, <span class="string">&quot;return_book&quot;</span>, <span class="string">&quot;add_book&quot;</span>]</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 日志配置</span></span><br><span class="line">  <span class="attr">logging:</span></span><br><span class="line">    <span class="comment"># 日志级别（debug, info, warning, error, critical）</span></span><br><span class="line">    <span class="attr">level:</span> <span class="string">&quot;info&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 日志文件路径</span></span><br><span class="line">    <span class="attr">file_path:</span> <span class="string">&quot;./logs/agent.log&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 是否输出到控制台</span></span><br><span class="line">    <span class="attr">console_output:</span> <span class="literal">true</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 数据库连接配置</span></span><br><span class="line">  <span class="attr">database:</span></span><br><span class="line">    <span class="comment"># 数据库类型</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;postgresql&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 连接主机</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">&quot;localhost&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 端口</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5432</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 数据库名称</span></span><br><span class="line">    <span class="attr">database:</span> <span class="string">&quot;library_db&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 用户名</span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">&quot;library_user&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 密码（环境变量）</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">&quot;$&#123;DB_PASSWORD&#125;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 连接池大小</span></span><br><span class="line">    <span class="attr">max_connections:</span> <span class="number">10</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 连接超时时间（秒）</span></span><br><span class="line">    <span class="attr">connection_timeout:</span> <span class="number">30</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 环境变量配置</span></span><br><span class="line"><span class="attr">environment:</span></span><br><span class="line">  <span class="comment"># 开发/测试/生产环境</span></span><br><span class="line">  <span class="attr">env:</span> <span class="string">&quot;development&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 调试模式</span></span><br><span class="line">  <span class="attr">debug:</span> <span class="literal">true</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 性能监控</span></span><br><span class="line">  <span class="attr">monitoring:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">metrics_port:</span> <span class="number">9090</span></span><br></pre></td></tr></table></figure><h3 id="3-2-技能配置文件示例-skills-borrow-book-yaml"><a href="#3-2-技能配置文件示例-skills-borrow-book-yaml" class="headerlink" title="3.2 技能配置文件示例 skills/borrow_book.yaml"></a>3.2 技能配置文件示例 <code>skills/borrow_book.yaml</code></h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 技能配置文件</span></span><br><span class="line"><span class="attr">skill:</span></span><br><span class="line">  <span class="comment"># 技能唯一标识符</span></span><br><span class="line">  <span class="attr">id:</span> <span class="string">&quot;borrow_book&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 技能名称</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">&quot;图书借阅技能&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 技能描述</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">&quot;处理用户借阅图书的请求，验证用户资格和图书可用性&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 技能版本</span></span><br><span class="line">  <span class="attr">version:</span> <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 技能作者</span></span><br><span class="line">  <span class="attr">author:</span> <span class="string">&quot;library-team&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 技能分类</span></span><br><span class="line">  <span class="attr">category:</span> <span class="string">&quot;library_operations&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 依赖的Skills</span></span><br><span class="line">  <span class="attr">dependencies:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;check_user_eligibility&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;check_book_availability&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 输入参数定义</span></span><br><span class="line">  <span class="attr">input_schema:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;object&quot;</span></span><br><span class="line">    <span class="attr">properties:</span></span><br><span class="line">      <span class="attr">user_id:</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">&quot;用户ID&quot;</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">book_id:</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">&quot;图书ID&quot;</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">borrow_date:</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">        <span class="attr">format:</span> <span class="string">&quot;date&quot;</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">&quot;借阅日期，格式YYYY-MM-DD&quot;</span></span><br><span class="line">        <span class="attr">default:</span> <span class="string">&quot;current_date&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 输出参数定义</span></span><br><span class="line">  <span class="attr">output_schema:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;object&quot;</span></span><br><span class="line">    <span class="attr">properties:</span></span><br><span class="line">      <span class="attr">success:</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">&quot;boolean&quot;</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">&quot;操作是否成功&quot;</span></span><br><span class="line">      <span class="attr">transaction_id:</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">&quot;交易ID&quot;</span></span><br><span class="line">      <span class="attr">due_date:</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">        <span class="attr">format:</span> <span class="string">&quot;date&quot;</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">&quot;应还日期&quot;</span></span><br><span class="line">      <span class="attr">message:</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">&quot;操作结果消息&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 执行逻辑配置</span></span><br><span class="line">  <span class="attr">execution:</span></span><br><span class="line">    <span class="comment"># 执行类型（python, javascript, shell等）</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;python&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 入口函数</span></span><br><span class="line">    <span class="attr">entry_point:</span> <span class="string">&quot;borrow_book.execute&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 超时时间（秒）</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">30</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 重试次数</span></span><br><span class="line">    <span class="attr">max_retries:</span> <span class="number">3</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 重试间隔（秒）</span></span><br><span class="line">    <span class="attr">retry_interval:</span> <span class="number">2</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 资源限制</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">    <span class="comment"># 内存限制（MB）</span></span><br><span class="line">    <span class="attr">memory_limit:</span> <span class="number">256</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># CPU限制（核数）</span></span><br><span class="line">    <span class="attr">cpu_limit:</span> <span class="number">0.5</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 网络访问权限</span></span><br><span class="line">    <span class="attr">network_access:</span> <span class="literal">false</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 错误处理</span></span><br><span class="line">  <span class="attr">error_handling:</span></span><br><span class="line">    <span class="comment"># 自定义错误映射</span></span><br><span class="line">    <span class="attr">error_codes:</span></span><br><span class="line">      <span class="attr">USER_NOT_FOUND:</span> <span class="string">&quot;用户不存在&quot;</span></span><br><span class="line">      <span class="attr">BOOK_NOT_AVAILABLE:</span> <span class="string">&quot;图书不可借阅&quot;</span></span><br><span class="line">      <span class="attr">MAX_BORROWS_REACHED:</span> <span class="string">&quot;已达到最大借阅数量&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 默认错误处理函数</span></span><br><span class="line">    <span class="attr">default_handler:</span> <span class="string">&quot;error_handlers.default_handler&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 缓存配置</span></span><br><span class="line">  <span class="attr">cache:</span></span><br><span class="line">    <span class="comment"># 是否启用缓存</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 缓存时间（秒）</span></span><br><span class="line">    <span class="attr">ttl:</span> <span class="number">60</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 缓存键生成策略</span></span><br><span class="line">    <span class="attr">key_strategy:</span> <span class="string">&quot;user_book_combination&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 监控指标</span></span><br><span class="line">  <span class="attr">metrics:</span></span><br><span class="line">    <span class="comment"># 启用性能监控</span></span><br><span class="line">    <span class="attr">enable_performance:</span> <span class="literal">true</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 自定义指标</span></span><br><span class="line">    <span class="attr">custom_metrics:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;borrow_success_rate&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;average_processing_time&quot;</span></span><br></pre></td></tr></table></figure><h2 id="四、部署架构与最佳实践"><a href="#四、部署架构与最佳实践" class="headerlink" title="四、部署架构与最佳实践"></a>四、部署架构与最佳实践</h2><h3 id="4-1-生产环境部署架构"><a href="#4-1-生产环境部署架构" class="headerlink" title="4.1 生产环境部署架构"></a>4.1 生产环境部署架构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">┌─────────────────────────────────────────────────────────────┐</span><br><span class="line">│                      负载均衡层                               │</span><br><span class="line">│                  Nginx/HAProxy                              │</span><br><span class="line">└───────────────────────────┬─────────────────────────────────┘</span><br><span class="line">                            │</span><br><span class="line">┌───────────────────────────▼─────────────────────────────────┐</span><br><span class="line">│                      应用服务层                               │</span><br><span class="line">│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │</span><br><span class="line">│  │  Agent-1    │  │  Agent-2    │  │  Agent-3    │          │</span><br><span class="line">│  │ (Primary)   │  │ (Backup)    │  │ (Read-only) │          │</span><br><span class="line">│  └─────────────┘  └─────────────┘  └─────────────┘          │</span><br><span class="line">└───────────────────────────┬─────────────────────────────────┘</span><br><span class="line">                            │</span><br><span class="line">┌───────────────────────────▼─────────────────────────────────┐</span><br><span class="line">│                      数据存储层                               │</span><br><span class="line">│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │</span><br><span class="line">│  │ PostgreSQL  │  │ Vector      │  │ Redis       │          │</span><br><span class="line">│  │ (主从复制)   │  │  DB (Chroma)│  │ (缓存)       │          │</span><br><span class="line">│  └─────────────┘  └─────────────┘  └─────────────┘          │</span><br><span class="line">└─────────────────────────────────────────────────────────────┘</span><br></pre></td></tr></table></figure><h3 id="4-2-容器化部署（Docker-Compose）"><a href="#4-2-容器化部署（Docker-Compose）" class="headerlink" title="4.2 容器化部署（Docker Compose）"></a>4.2 容器化部署（Docker Compose）</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="comment"># Agent主服务</span></span><br><span class="line">  <span class="attr">agent-service:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">Dockerfile.agent</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">library-agent</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8080:8080&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9090:9090&quot;</span>  <span class="comment"># 监控端口</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">OPENAI_API_KEY=$&#123;OPENAI_API_KEY&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DB_PASSWORD=$&#123;DB_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ENVIRONMENT=production</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./skills:/app/skills</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./data:/app/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./logs:/app/logs</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">postgres</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">vector-db</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">healthcheck:</span></span><br><span class="line">      <span class="attr">test:</span> [<span class="string">&quot;CMD&quot;</span>, <span class="string">&quot;curl&quot;</span>, <span class="string">&quot;-f&quot;</span>, <span class="string">&quot;http://localhost:8080/health&quot;</span>]</span><br><span class="line">      <span class="attr">interval:</span> <span class="string">30s</span></span><br><span class="line">      <span class="attr">timeout:</span> <span class="string">10s</span></span><br><span class="line">      <span class="attr">retries:</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># PostgreSQL数据库</span></span><br><span class="line">  <span class="attr">postgres:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">postgres:15-alpine</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">library-postgres</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_DB=library_db</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_USER=library_user</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_PASSWORD=$&#123;DB_PASSWORD&#125;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">postgres_data:/var/lib/postgresql/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./init.sql:/docker-entrypoint-initdb.d/init.sql</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;5432:5432&quot;</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Redis缓存</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:7-alpine</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">library-redis</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6379:6379&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_data:/data</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 向量数据库</span></span><br><span class="line">  <span class="attr">vector-db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">chromadb/chroma:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">library-vector-db</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8000:8000&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">vector_data:/chroma</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 监控服务</span></span><br><span class="line">  <span class="attr">prometheus:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">prom/prometheus:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">agent-prometheus</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9091:9090&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./prometheus.yml:/etc/prometheus/prometheus.yml</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">agent-service</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">postgres_data:</span></span><br><span class="line">  <span class="attr">redis_data:</span></span><br><span class="line">  <span class="attr">vector_data:</span></span><br></pre></td></tr></table></figure><h3 id="4-3-关键注意事项"><a href="#4-3-关键注意事项" class="headerlink" title="4.3 关键注意事项"></a>4.3 关键注意事项</h3><p><strong>⚠️ 重要注意事项：</strong></p><ol><li><p><strong>安全隔离</strong>：生产环境中必须启用沙箱模式，限制Skills的网络访问权限，防止恶意代码执行。</p></li><li><p><strong>性能优化</strong>：Skills的执行超时时间应根据业务场景合理设置，避免阻塞Agent主线程。</p></li><li><p><strong>版本控制</strong>：Skills必须严格遵循语义化版本控制，确保向后兼容性。</p></li><li><p><strong>监控告警</strong>：必须配置完整的监控指标，包括技能执行成功率、响应时间、资源使用率等。</p></li><li><p><strong>灾备策略</strong>：Agent服务应部署多实例，实现故障自动切换，确保服务高可用。</p></li></ol><h2 id="五、实战Demo：图书馆借书管理系统"><a href="#五、实战Demo：图书馆借书管理系统" class="headerlink" title="五、实战Demo：图书馆借书管理系统"></a>五、实战Demo：图书馆借书管理系统</h2><h3 id="5-1-数据库设计（PostgreSQL）"><a href="#5-1-数据库设计（PostgreSQL）" class="headerlink" title="5.1 数据库设计（PostgreSQL）"></a>5.1 数据库设计（PostgreSQL）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 图书表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> books (</span><br><span class="line">    id <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    title <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    author <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    isbn <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">UNIQUE</span>,</span><br><span class="line">    category <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    total_copies <span class="type">INTEGER</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>,</span><br><span class="line">    available_copies <span class="type">INTEGER</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>,</span><br><span class="line">    published_year <span class="type">INTEGER</span>,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    updated_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 用户表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">    id <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">UNIQUE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    phone <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">    max_borrow_limit <span class="type">INTEGER</span> <span class="keyword">DEFAULT</span> <span class="number">5</span>,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    updated_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 借阅记录表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> borrow_records (</span><br><span class="line">    id SERIAL <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    user_id <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">REFERENCES</span> users(id),</span><br><span class="line">    book_id <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">REFERENCES</span> books(id),</span><br><span class="line">    borrow_date <span class="type">DATE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    due_date <span class="type">DATE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    return_date <span class="type">DATE</span>,</span><br><span class="line">    status <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;borrowed&#x27;</span> <span class="keyword">CHECK</span> (status <span class="keyword">IN</span> (<span class="string">&#x27;borrowed&#x27;</span>, <span class="string">&#x27;returned&#x27;</span>, <span class="string">&#x27;overdue&#x27;</span>)),</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    updated_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 索引优化</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_borrow_records_user <span class="keyword">ON</span> borrow_records(user_id);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_borrow_records_book <span class="keyword">ON</span> borrow_records(book_id);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_borrow_records_status <span class="keyword">ON</span> borrow_records(status);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 触发器：更新图书可用数量</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">FUNCTION</span> update_book_availability()</span><br><span class="line"><span class="keyword">RETURNS</span> <span class="keyword">TRIGGER</span> <span class="keyword">AS</span> $$</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    IF NEW.status <span class="operator">=</span> <span class="string">&#x27;borrowed&#x27;</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">UPDATE</span> books <span class="keyword">SET</span> available_copies <span class="operator">=</span> available_copies <span class="operator">-</span> <span class="number">1</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> NEW.book_id;</span><br><span class="line">    ELSIF NEW.status <span class="operator">=</span> <span class="string">&#x27;returned&#x27;</span> <span class="keyword">AND</span> OLD.status <span class="operator">=</span> <span class="string">&#x27;borrowed&#x27;</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">UPDATE</span> books <span class="keyword">SET</span> available_copies <span class="operator">=</span> available_copies <span class="operator">+</span> <span class="number">1</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> NEW.book_id;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">RETURN</span> <span class="keyword">NEW</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line">$$ <span class="keyword">LANGUAGE</span> plpgsql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_update_book_availability</span><br><span class="line">AFTER <span class="keyword">INSERT</span> <span class="keyword">OR</span> <span class="keyword">UPDATE</span> <span class="keyword">ON</span> borrow_records</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> <span class="keyword">EXECUTE</span> <span class="keyword">FUNCTION</span> update_book_availability();</span><br></pre></td></tr></table></figure><h3 id="5-2-Python实现（基于LangChain）"><a href="#5-2-Python实现（基于LangChain）" class="headerlink" title="5.2 Python实现（基于LangChain）"></a>5.2 Python实现（基于LangChain）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># library_agent.py</span></span><br><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> AgentExecutor, create_tool_calling_agent</span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI</span><br><span class="line"><span class="keyword">from</span> langchain_community.utilities <span class="keyword">import</span> SQLDatabase</span><br><span class="line"><span class="keyword">from</span> langchain_community.agent_toolkits <span class="keyword">import</span> SQLDatabaseToolkit</span><br><span class="line"><span class="keyword">from</span> langchain_core.tools <span class="keyword">import</span> tool</span><br><span class="line"><span class="keyword">import</span> psycopg2</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Dict</span>, <span class="type">Any</span>, <span class="type">List</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LibraryAgent</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 初始化数据库连接</span></span><br><span class="line">        self.db = SQLDatabase.from_uri(</span><br><span class="line">            <span class="string">f&quot;postgresql://<span class="subst">&#123;os.getenv(<span class="string">&#x27;DB_USER&#x27;</span>)&#125;</span>:<span class="subst">&#123;os.getenv(<span class="string">&#x27;DB_PASSWORD&#x27;</span>)&#125;</span>@<span class="subst">&#123;os.getenv(<span class="string">&#x27;DB_HOST&#x27;</span>)&#125;</span>/<span class="subst">&#123;os.getenv(<span class="string">&#x27;DB_NAME&#x27;</span>)&#125;</span>&quot;</span></span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 初始化LLM</span></span><br><span class="line">        self.llm = ChatOpenAI(</span><br><span class="line">            model=<span class="string">&quot;gpt-4-turbo&quot;</span>,</span><br><span class="line">            temperature=<span class="number">0.3</span>,</span><br><span class="line">            api_key=os.getenv(<span class="string">&quot;OPENAI_API_KEY&quot;</span>)</span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 创建工具包</span></span><br><span class="line">        self.toolkit = SQLDatabaseToolkit(db=self.db, llm=self.llm)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 定义专业工具</span></span><br><span class="line">        self.tools = [</span><br><span class="line">            self.borrow_book_tool,</span><br><span class="line">            self.return_book_tool,</span><br><span class="line">            self.check_availability_tool,</span><br><span class="line">            self.get_user_info_tool,</span><br><span class="line">            self.search_books_tool</span><br><span class="line">        ] + self.toolkit.get_tools()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 创建Agent</span></span><br><span class="line">        self.agent = self.create_agent()</span><br><span class="line">        self.agent_executor = AgentExecutor(</span><br><span class="line">            agent=self.agent,</span><br><span class="line">            tools=self.tools,</span><br><span class="line">            verbose=<span class="literal">True</span>,</span><br><span class="line">            max_iterations=<span class="number">10</span>,</span><br><span class="line">            early_stopping_method=<span class="string">&quot;force&quot;</span></span><br><span class="line">        )</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_agent</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;创建图书馆管理Agent&quot;&quot;&quot;</span></span><br><span class="line">        prompt = ChatPromptTemplate.from_messages([</span><br><span class="line">            (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;&quot;&quot;你是一个专业的图书馆管理助手，负责处理图书借阅、归还、查询等业务。</span></span><br><span class="line"><span class="string">            请根据用户请求选择合适的工具执行操作，并提供清晰、友好的回复。</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            可用工具：</span></span><br><span class="line"><span class="string">            - borrow_book_tool: 处理图书借阅</span></span><br><span class="line"><span class="string">            - return_book_tool: 处理图书归还  </span></span><br><span class="line"><span class="string">            - check_availability_tool: 检查图书可用性</span></span><br><span class="line"><span class="string">            - get_user_info_tool: 获取用户信息</span></span><br><span class="line"><span class="string">            - search_books_tool: 搜索图书</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            重要规则：</span></span><br><span class="line"><span class="string">            1. 借书前必须检查用户资格和图书可用性</span></span><br><span class="line"><span class="string">            2. 归还图书时需要验证借阅记录</span></span><br><span class="line"><span class="string">            3. 所有操作都需要记录日志</span></span><br><span class="line"><span class="string">            4. 遇到错误时提供友好的错误提示&quot;&quot;&quot;</span>),</span><br><span class="line">            (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;&#123;input&#125;&quot;</span>),</span><br><span class="line">            (<span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;&#123;agent_scratchpad&#125;&quot;</span>)</span><br><span class="line">        ])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> create_tool_calling_agent(self.llm, self.tools, prompt)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @tool</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">borrow_book_tool</span>(<span class="params">self, user_id: <span class="built_in">str</span>, book_id: <span class="built_in">str</span></span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;借阅图书工具&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 检查用户资格</span></span><br><span class="line">            user_info = self.get_user_info_tool(user_id)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> user_info[<span class="string">&quot;eligible&quot;</span>]:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&quot;success&quot;</span>: <span class="literal">False</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;用户借阅资格不足&quot;</span>&#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 检查图书可用性</span></span><br><span class="line">            availability = self.check_availability_tool(book_id)</span><br><span class="line">            <span class="keyword">if</span> availability[<span class="string">&quot;available_copies&quot;</span>] &lt;= <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&quot;success&quot;</span>: <span class="literal">False</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;图书暂无库存&quot;</span>&#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 执行借阅</span></span><br><span class="line">            conn = self.get_db_connection()</span><br><span class="line">            cursor = conn.cursor()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 创建借阅记录</span></span><br><span class="line">            borrow_date = datetime.now().date()</span><br><span class="line">            due_date = borrow_date + timedelta(days=<span class="number">14</span>)  <span class="comment"># 14天借阅期</span></span><br><span class="line">            </span><br><span class="line">            cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                INSERT INTO borrow_records (user_id, book_id, borrow_date, due_date, status)</span></span><br><span class="line"><span class="string">                VALUES (%s, %s, %s, %s, &#x27;borrowed&#x27;)</span></span><br><span class="line"><span class="string">                RETURNING id, due_date</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>, (user_id, book_id, borrow_date, due_date))</span><br><span class="line">            </span><br><span class="line">            result = cursor.fetchone()</span><br><span class="line">            transaction_id, due_date = result</span><br><span class="line">            </span><br><span class="line">            conn.commit()</span><br><span class="line">            cursor.close()</span><br><span class="line">            conn.close()</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="string">&quot;success&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">                <span class="string">&quot;transaction_id&quot;</span>: transaction_id,</span><br><span class="line">                <span class="string">&quot;due_date&quot;</span>: due_date.strftime(<span class="string">&quot;%Y-%m-%d&quot;</span>),</span><br><span class="line">                <span class="string">&quot;message&quot;</span>: <span class="string">f&quot;借阅成功！请在<span class="subst">&#123;due_date.strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)&#125;</span>前归还。&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;success&quot;</span>: <span class="literal">False</span>, <span class="string">&quot;message&quot;</span>: <span class="string">f&quot;借阅失败: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>&#125;</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @tool</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">return_book_tool</span>(<span class="params">self, user_id: <span class="built_in">str</span>, book_id: <span class="built_in">str</span></span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;归还图书工具&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            conn = self.get_db_connection()</span><br><span class="line">            cursor = conn.cursor()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 查找未归还的借阅记录</span></span><br><span class="line">            cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                SELECT id FROM borrow_records </span></span><br><span class="line"><span class="string">                WHERE user_id = %s AND book_id = %s AND status = &#x27;borrowed&#x27;</span></span><br><span class="line"><span class="string">                ORDER BY borrow_date DESC LIMIT 1</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>, (user_id, book_id))</span><br><span class="line">            </span><br><span class="line">            record = cursor.fetchone()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> record:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&quot;success&quot;</span>: <span class="literal">False</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;未找到相关借阅记录&quot;</span>&#125;</span><br><span class="line">            </span><br><span class="line">            record_id = record[<span class="number">0</span>]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 更新归还状态</span></span><br><span class="line">            return_date = datetime.now().date()</span><br><span class="line">            cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                UPDATE borrow_records </span></span><br><span class="line"><span class="string">                SET status = &#x27;returned&#x27;, return_date = %s </span></span><br><span class="line"><span class="string">                WHERE id = %s</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>, (return_date, record_id))</span><br><span class="line">            </span><br><span class="line">            conn.commit()</span><br><span class="line">            cursor.close()</span><br><span class="line">            conn.close()</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="string">&quot;success&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">                <span class="string">&quot;message&quot;</span>: <span class="string">&quot;图书归还成功！感谢您的使用。&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;success&quot;</span>: <span class="literal">False</span>, <span class="string">&quot;message&quot;</span>: <span class="string">f&quot;归还失败: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>&#125;</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @tool</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check_availability_tool</span>(<span class="params">self, book_id: <span class="built_in">str</span></span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;检查图书可用性&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            conn = self.get_db_connection()</span><br><span class="line">            cursor = conn.cursor()</span><br><span class="line">            </span><br><span class="line">            cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                SELECT title, author, total_copies, available_copies </span></span><br><span class="line"><span class="string">                FROM books WHERE id = %s</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>, (book_id,))</span><br><span class="line">            </span><br><span class="line">            book = cursor.fetchone()</span><br><span class="line">            cursor.close()</span><br><span class="line">            conn.close()</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> book:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&quot;available&quot;</span>: <span class="literal">False</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;图书不存在&quot;</span>&#125;</span><br><span class="line">            </span><br><span class="line">            title, author, total, available = book</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="string">&quot;available&quot;</span>: available &gt; <span class="number">0</span>,</span><br><span class="line">                <span class="string">&quot;book_title&quot;</span>: title,</span><br><span class="line">                <span class="string">&quot;author&quot;</span>: author,</span><br><span class="line">                <span class="string">&quot;total_copies&quot;</span>: total,</span><br><span class="line">                <span class="string">&quot;available_copies&quot;</span>: available,</span><br><span class="line">                <span class="string">&quot;message&quot;</span>: <span class="string">f&quot;《<span class="subst">&#123;title&#125;</span>》当前有<span class="subst">&#123;available&#125;</span>本可借&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;error&quot;</span>: <span class="built_in">str</span>(e)&#125;</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @tool</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_user_info_tool</span>(<span class="params">self, user_id: <span class="built_in">str</span></span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;获取用户信息&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            conn = self.get_db_connection()</span><br><span class="line">            cursor = conn.cursor()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 获取用户基本信息</span></span><br><span class="line">            cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                SELECT name, email, max_borrow_limit FROM users WHERE id = %s</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>, (user_id,))</span><br><span class="line">            user = cursor.fetchone()</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> user:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&quot;eligible&quot;</span>: <span class="literal">False</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;用户不存在&quot;</span>&#125;</span><br><span class="line">            </span><br><span class="line">            name, email, max_limit = user</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 获取当前借阅数量</span></span><br><span class="line">            cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                SELECT COUNT(*) FROM borrow_records </span></span><br><span class="line"><span class="string">                WHERE user_id = %s AND status = &#x27;borrowed&#x27;</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>, (user_id,))</span><br><span class="line">            current_borrows = cursor.fetchone()[<span class="number">0</span>]</span><br><span class="line">            </span><br><span class="line">            cursor.close()</span><br><span class="line">            conn.close()</span><br><span class="line">            </span><br><span class="line">            eligible = current_borrows &lt; max_limit</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="string">&quot;eligible&quot;</span>: eligible,</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">                <span class="string">&quot;email&quot;</span>: email,</span><br><span class="line">                <span class="string">&quot;max_borrow_limit&quot;</span>: max_limit,</span><br><span class="line">                <span class="string">&quot;current_borrows&quot;</span>: current_borrows,</span><br><span class="line">                <span class="string">&quot;remaining_limit&quot;</span>: max_limit - current_borrows,</span><br><span class="line">                <span class="string">&quot;message&quot;</span>: eligible <span class="keyword">and</span> <span class="string">&quot;用户借阅资格正常&quot;</span> <span class="keyword">or</span> <span class="string">&quot;已达到最大借阅数量&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;error&quot;</span>: <span class="built_in">str</span>(e)&#125;</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @tool</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">search_books_tool</span>(<span class="params">self, query: <span class="built_in">str</span>, category: <span class="built_in">str</span> = <span class="literal">None</span></span>) -&gt; <span class="type">List</span>[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;搜索图书&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            conn = self.get_db_connection()</span><br><span class="line">            cursor = conn.cursor()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 构建查询条件</span></span><br><span class="line">            conditions = []</span><br><span class="line">            params = [<span class="string">f&quot;%<span class="subst">&#123;query&#125;</span>%&quot;</span>]</span><br><span class="line">            sql = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                SELECT id, title, author, isbn, category, available_copies </span></span><br><span class="line"><span class="string">                FROM books </span></span><br><span class="line"><span class="string">                WHERE title ILIKE %s OR author ILIKE %s OR isbn ILIKE %s</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">            conditions.extend([<span class="string">f&quot;%<span class="subst">&#123;query&#125;</span>%&quot;</span>, <span class="string">f&quot;%<span class="subst">&#123;query&#125;</span>%&quot;</span>, <span class="string">f&quot;%<span class="subst">&#123;query&#125;</span>%&quot;</span>])</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> category:</span><br><span class="line">                sql += <span class="string">&quot; AND category = %s&quot;</span></span><br><span class="line">                conditions.append(category)</span><br><span class="line">            </span><br><span class="line">            sql += <span class="string">&quot; ORDER BY title LIMIT 10&quot;</span></span><br><span class="line">            </span><br><span class="line">            cursor.execute(sql, <span class="built_in">tuple</span>(conditions))</span><br><span class="line">            books = cursor.fetchall()</span><br><span class="line">            cursor.close()</span><br><span class="line">            conn.close()</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;id&quot;</span>: book[<span class="number">0</span>],</span><br><span class="line">                    <span class="string">&quot;title&quot;</span>: book[<span class="number">1</span>],</span><br><span class="line">                    <span class="string">&quot;author&quot;</span>: book[<span class="number">2</span>],</span><br><span class="line">                    <span class="string">&quot;isbn&quot;</span>: book[<span class="number">3</span>],</span><br><span class="line">                    <span class="string">&quot;category&quot;</span>: book[<span class="number">4</span>],</span><br><span class="line">                    <span class="string">&quot;available_copies&quot;</span>: book[<span class="number">5</span>]</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> book <span class="keyword">in</span> books</span><br><span class="line">            ]</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> [&#123;<span class="string">&quot;error&quot;</span>: <span class="built_in">str</span>(e)&#125;]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_db_connection</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;获取数据库连接&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> psycopg2.connect(</span><br><span class="line">            host=os.getenv(<span class="string">&#x27;DB_HOST&#x27;</span>, <span class="string">&#x27;localhost&#x27;</span>),</span><br><span class="line">            database=os.getenv(<span class="string">&#x27;DB_NAME&#x27;</span>, <span class="string">&#x27;library_db&#x27;</span>),</span><br><span class="line">            user=os.getenv(<span class="string">&#x27;DB_USER&#x27;</span>, <span class="string">&#x27;library_user&#x27;</span>),</span><br><span class="line">            password=os.getenv(<span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;&#x27;</span>),</span><br><span class="line">            port=os.getenv(<span class="string">&#x27;DB_PORT&#x27;</span>, <span class="string">&#x27;5432&#x27;</span>)</span><br><span class="line">        )</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self, user_input: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;运行Agent处理用户输入&quot;&quot;&quot;</span></span><br><span class="line">        result = self.agent_executor.invoke(&#123;<span class="string">&quot;input&quot;</span>: user_input&#125;)</span><br><span class="line">        <span class="keyword">return</span> result[<span class="string">&quot;output&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用示例</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 设置环境变量</span></span><br><span class="line">    os.environ[<span class="string">&quot;OPENAI_API_KEY&quot;</span>] = <span class="string">&quot;your-api-key&quot;</span></span><br><span class="line">    os.environ[<span class="string">&quot;DB_HOST&quot;</span>] = <span class="string">&quot;localhost&quot;</span></span><br><span class="line">    os.environ[<span class="string">&quot;DB_NAME&quot;</span>] = <span class="string">&quot;library_db&quot;</span></span><br><span class="line">    os.environ[<span class="string">&quot;DB_USER&quot;</span>] = <span class="string">&quot;library_user&quot;</span></span><br><span class="line">    os.environ[<span class="string">&quot;DB_PASSWORD&quot;</span>] = <span class="string">&quot;your-db-password&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 初始化Agent</span></span><br><span class="line">    agent = LibraryAgent()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 测试对话</span></span><br><span class="line">    test_inputs = [</span><br><span class="line">        <span class="string">&quot;我想借一本《人工智能导论》&quot;</span>,</span><br><span class="line">        <span class="string">&quot;用户user123可以借多少本书？&quot;</span>,</span><br><span class="line">        <span class="string">&quot;帮我查找所有编程类的图书&quot;</span>,</span><br><span class="line">        <span class="string">&quot;我要归还《机器学习实战》&quot;</span></span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> user_input <span class="keyword">in</span> test_inputs:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n用户: <span class="subst">&#123;user_input&#125;</span>&quot;</span>)</span><br><span class="line">        response = agent.run(user_input)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;助手: <span class="subst">&#123;response&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="5-3-Go语言实现"><a href="#5-3-Go语言实现" class="headerlink" title="5.3 Go语言实现"></a>5.3 Go语言实现</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;context&quot;</span></span><br><span class="line">	<span class="string">&quot;database/sql&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/jackc/pgx/v5/pgxpool&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/sashabaranov/go-openai&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> LibraryAgent <span class="keyword">struct</span> &#123;</span><br><span class="line">	db        *pgxpool.Pool</span><br><span class="line">	openai    *openai.Client</span><br><span class="line">	config    *AgentConfig</span><br><span class="line">	skills    <span class="keyword">map</span>[<span class="type">string</span>]Skill</span><br><span class="line">	tools     <span class="keyword">map</span>[<span class="type">string</span>]Tool</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Skill <span class="keyword">interface</span> &#123;</span><br><span class="line">	Execute(ctx context.Context, params <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;) (<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;, <span class="type">error</span>)</span><br><span class="line">	GetDescription() <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Tool <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name        <span class="type">string</span></span><br><span class="line">	Description <span class="type">string</span></span><br><span class="line">	Handler     <span class="function"><span class="keyword">func</span><span class="params">(ctx context.Context, params <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span></span> (<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;, <span class="type">error</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> AgentConfig <span class="keyword">struct</span> &#123;</span><br><span class="line">	DatabaseURL <span class="type">string</span></span><br><span class="line">	OpenAIAPIKey <span class="type">string</span></span><br><span class="line">	MaxBorrowDays <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewLibraryAgent</span><span class="params">(config *AgentConfig)</span></span> (*LibraryAgent, <span class="type">error</span>) &#123;</span><br><span class="line">	<span class="comment">// 初始化数据库连接</span></span><br><span class="line">	dbPool, err := pgxpool.New(context.Background(), config.DatabaseURL)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;数据库连接失败: %v&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 初始化OpenAI客户端</span></span><br><span class="line">	openaiClient := openai.NewClient(config.OpenAIAPIKey)</span><br><span class="line">	</span><br><span class="line">	agent := &amp;LibraryAgent&#123;</span><br><span class="line">		db:        dbPool,</span><br><span class="line">		openai:    openaiClient,</span><br><span class="line">		config:    config,</span><br><span class="line">		skills:    <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]Skill),</span><br><span class="line">		tools:     <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]Tool),</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 注册技能</span></span><br><span class="line">	agent.registerSkills()</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 注册工具</span></span><br><span class="line">	agent.registerTools()</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> agent, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *LibraryAgent)</span></span> registerSkills() &#123;</span><br><span class="line">	<span class="comment">// 借书技能</span></span><br><span class="line">	a.skills[<span class="string">&quot;borrow_book&quot;</span>] = &amp;BorrowBookSkill&#123;agent: a&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 还书技能</span></span><br><span class="line">	a.skills[<span class="string">&quot;return_book&quot;</span>] = &amp;ReturnBookSkill&#123;agent: a&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 查询技能</span></span><br><span class="line">	a.skills[<span class="string">&quot;search_books&quot;</span>] = &amp;SearchBooksSkill&#123;agent: a&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *LibraryAgent)</span></span> registerTools() &#123;</span><br><span class="line">	a.tools[<span class="string">&quot;check_availability&quot;</span>] = Tool&#123;</span><br><span class="line">		Name:        <span class="string">&quot;check_availability&quot;</span>,</span><br><span class="line">		Description: <span class="string">&quot;检查图书可用性&quot;</span>,</span><br><span class="line">		Handler:     a.handleCheckAvailability,</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	a.tools[<span class="string">&quot;get_user_info&quot;</span>] = Tool&#123;</span><br><span class="line">		Name:        <span class="string">&quot;get_user_info&quot;</span>,</span><br><span class="line">		Description: <span class="string">&quot;获取用户信息&quot;</span>,</span><br><span class="line">		Handler:     a.handleGetUserInfo,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> BorrowBookSkill <span class="keyword">struct</span> &#123;</span><br><span class="line">	agent *LibraryAgent</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *BorrowBookSkill)</span></span> Execute(ctx context.Context, params <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;) (<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;, <span class="type">error</span>) &#123;</span><br><span class="line">	userID, ok := params[<span class="string">&quot;user_id&quot;</span>].(<span class="type">string</span>)</span><br><span class="line">	<span class="keyword">if</span> !ok &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;缺少用户ID&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	bookID, ok := params[<span class="string">&quot;book_id&quot;</span>].(<span class="type">string</span>)</span><br><span class="line">	<span class="keyword">if</span> !ok &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;缺少图书ID&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 检查用户资格</span></span><br><span class="line">	userInfo, err := s.agent.tools[<span class="string">&quot;get_user_info&quot;</span>].Handler(ctx, <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;<span class="string">&quot;user_id&quot;</span>: userID&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> !userInfo[<span class="string">&quot;eligible&quot;</span>].(<span class="type">bool</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">			<span class="string">&quot;success&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: <span class="string">&quot;用户借阅资格不足&quot;</span>,</span><br><span class="line">		&#125;, <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 检查图书可用性</span></span><br><span class="line">	availability, err := s.agent.tools[<span class="string">&quot;check_availability&quot;</span>].Handler(ctx, <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;<span class="string">&quot;book_id&quot;</span>: bookID&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> availability[<span class="string">&quot;available_copies&quot;</span>].(<span class="type">int</span>) &lt;= <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">			<span class="string">&quot;success&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: <span class="string">&quot;图书暂无库存&quot;</span>,</span><br><span class="line">		&#125;, <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 执行借阅</span></span><br><span class="line">	tx, err := s.agent.db.Begin(ctx)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> tx.Rollback(ctx)</span><br><span class="line">	</span><br><span class="line">	borrowDate := time.Now().Format(<span class="string">&quot;2006-01-02&quot;</span>)</span><br><span class="line">	dueDate := time.Now().AddDate(<span class="number">0</span>, <span class="number">0</span>, s.agent.config.MaxBorrowDays).Format(<span class="string">&quot;2006-01-02&quot;</span>)</span><br><span class="line">	</span><br><span class="line">	_, err = tx.Exec(ctx, <span class="string">`</span></span><br><span class="line"><span class="string">		INSERT INTO borrow_records (user_id, book_id, borrow_date, due_date, status)</span></span><br><span class="line"><span class="string">		VALUES ($1, $2, $3, $4, &#x27;borrowed&#x27;)</span></span><br><span class="line"><span class="string">		RETURNING id</span></span><br><span class="line"><span class="string">	`</span>, userID, bookID, borrowDate, dueDate)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> err := tx.Commit(ctx); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">		<span class="string">&quot;success&quot;</span>:     <span class="literal">true</span>,</span><br><span class="line">		<span class="string">&quot;due_date&quot;</span>:    dueDate,</span><br><span class="line">		<span class="string">&quot;message&quot;</span>:     fmt.Sprintf(<span class="string">&quot;借阅成功！请在%s前归还。&quot;</span>, dueDate),</span><br><span class="line">	&#125;, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *BorrowBookSkill)</span></span> GetDescription() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;处理图书借阅请求，验证用户资格和图书可用性&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	config := &amp;AgentConfig&#123;</span><br><span class="line">		DatabaseURL:  <span class="string">&quot;postgres://library_user:password@localhost:5432/library_db&quot;</span>,</span><br><span class="line">		OpenAIAPIKey: os.Getenv(<span class="string">&quot;OPENAI_API_KEY&quot;</span>),</span><br><span class="line">		MaxBorrowDays: <span class="number">14</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	agent, err := NewLibraryAgent(config)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalf(<span class="string">&quot;初始化Agent失败: %v&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">defer</span> agent.db.Close()</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 测试借书技能</span></span><br><span class="line">	ctx := context.Background()</span><br><span class="line">	params := <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">		<span class="string">&quot;user_id&quot;</span>: <span class="string">&quot;user123&quot;</span>,</span><br><span class="line">		<span class="string">&quot;book_id&quot;</span>: <span class="string">&quot;book456&quot;</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	result, err := agent.skills[<span class="string">&quot;borrow_book&quot;</span>].Execute(ctx, params)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Printf(<span class="string">&quot;技能执行失败: %v&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	fmt.Printf(<span class="string">&quot;结果: %+v\n&quot;</span>, result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-4-PHP实现"><a href="#5-4-PHP实现" class="headerlink" title="5.4 PHP实现"></a>5.4 PHP实现</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// library_agent.php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;vendor/autoload.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">OpenAI</span>\<span class="title">Client</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">OpenAI</span>\<span class="title">Factory</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PgSql</span>\<span class="title">Connection</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LibraryAgent</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$db</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$openai</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$skills</span> = [];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$tools</span> = [];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$config</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$config</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;config = <span class="variable">$config</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 初始化数据库连接</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;db = <span class="title function_ invoke__">pg_connect</span>(<span class="variable">$config</span>[<span class="string">&#x27;database_url&#x27;</span>]);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">$this</span>-&gt;db) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;数据库连接失败: &quot;</span> . <span class="title function_ invoke__">pg_last_error</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 初始化OpenAI客户端</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;openai = <span class="title class_">Factory</span>::<span class="title function_ invoke__">factory</span>()-&gt;<span class="title function_ invoke__">getClient</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 注册技能</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">registerSkills</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 注册工具</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">registerTools</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">registerSkills</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;skills[<span class="string">&#x27;borrow_book&#x27;</span>] = <span class="keyword">new</span> <span class="title class_">BorrowBookSkill</span>(<span class="variable language_">$this</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;skills[<span class="string">&#x27;return_book&#x27;</span>] = <span class="keyword">new</span> <span class="title class_">ReturnBookSkill</span>(<span class="variable language_">$this</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;skills[<span class="string">&#x27;search_books&#x27;</span>] = <span class="keyword">new</span> <span class="title class_">SearchBooksSkill</span>(<span class="variable language_">$this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">registerTools</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;tools[<span class="string">&#x27;check_availability&#x27;</span>] = [</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;check_availability&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;description&#x27;</span> =&gt; <span class="string">&#x27;检查图书可用性&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;handler&#x27;</span> =&gt; [<span class="variable language_">$this</span>, <span class="string">&#x27;handleCheckAvailability&#x27;</span>]</span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;tools[<span class="string">&#x27;get_user_info&#x27;</span>] = [</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;get_user_info&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;description&#x27;</span> =&gt; <span class="string">&#x27;获取用户信息&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;handler&#x27;</span> =&gt; [<span class="variable language_">$this</span>, <span class="string">&#x27;handleGetUserInfo&#x27;</span>]</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">executeSkill</span>(<span class="params"><span class="variable">$skillName</span>, <span class="variable">$params</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;skills[<span class="variable">$skillName</span>])) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;技能不存在: &quot;</span> . <span class="variable">$skillName</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;skills[<span class="variable">$skillName</span>]-&gt;<span class="title function_ invoke__">execute</span>(<span class="variable">$params</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handleCheckAvailability</span>(<span class="params"><span class="variable">$params</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$bookId</span> = <span class="variable">$params</span>[<span class="string">&#x27;book_id&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$query</span> = <span class="string">&quot;SELECT title, author, total_copies, available_copies FROM books WHERE id = <span class="subst">$1</span>&quot;</span>;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">pg_query_params</span>(<span class="variable">$this</span>-&gt;db, <span class="variable">$query</span>, [<span class="variable">$bookId</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$result</span> || <span class="title function_ invoke__">pg_num_rows</span>(<span class="variable">$result</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> [</span><br><span class="line">                <span class="string">&#x27;available&#x27;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">                <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;图书不存在&#x27;</span></span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$book</span> = <span class="title function_ invoke__">pg_fetch_assoc</span>(<span class="variable">$result</span>);</span><br><span class="line">        <span class="variable">$available</span> = (<span class="keyword">int</span>)<span class="variable">$book</span>[<span class="string">&#x27;available_copies&#x27;</span>] &gt; <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">&#x27;available&#x27;</span> =&gt; <span class="variable">$available</span>,</span><br><span class="line">            <span class="string">&#x27;book_title&#x27;</span> =&gt; <span class="variable">$book</span>[<span class="string">&#x27;title&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;author&#x27;</span> =&gt; <span class="variable">$book</span>[<span class="string">&#x27;author&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;total_copies&#x27;</span> =&gt; (<span class="keyword">int</span>)<span class="variable">$book</span>[<span class="string">&#x27;total_copies&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;available_copies&#x27;</span> =&gt; (<span class="keyword">int</span>)<span class="variable">$book</span>[<span class="string">&#x27;available_copies&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;message&#x27;</span> =&gt; <span class="variable">$available</span> ? <span class="string">&quot;《<span class="subst">&#123;$book[&#x27;title&#x27;]&#125;</span>》当前有<span class="subst">&#123;$book[&#x27;available_copies&#x27;]&#125;</span>本可借&quot;</span> : <span class="string">&quot;《<span class="subst">&#123;$book[&#x27;title&#x27;]&#125;</span>》暂无库存&quot;</span></span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handleGetUserInfo</span>(<span class="params"><span class="variable">$params</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$userId</span> = <span class="variable">$params</span>[<span class="string">&#x27;user_id&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$query</span> = <span class="string">&quot;SELECT name, email, max_borrow_limit FROM users WHERE id = <span class="subst">$1</span>&quot;</span>;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">pg_query_params</span>(<span class="variable">$this</span>-&gt;db, <span class="variable">$query</span>, [<span class="variable">$userId</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$result</span> || <span class="title function_ invoke__">pg_num_rows</span>(<span class="variable">$result</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> [</span><br><span class="line">                <span class="string">&#x27;eligible&#x27;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">                <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;用户不存在&#x27;</span></span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$user</span> = <span class="title function_ invoke__">pg_fetch_assoc</span>(<span class="variable">$result</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 获取当前借阅数量</span></span><br><span class="line">        <span class="variable">$borrowQuery</span> = <span class="string">&quot;SELECT COUNT(*) as current_borrows FROM borrow_records WHERE user_id = <span class="subst">$1</span> AND status = &#x27;borrowed&#x27;&quot;</span>;</span><br><span class="line">        <span class="variable">$borrowResult</span> = <span class="title function_ invoke__">pg_query_params</span>(<span class="variable">$this</span>-&gt;db, <span class="variable">$borrowQuery</span>, [<span class="variable">$userId</span>]);</span><br><span class="line">        <span class="variable">$borrowData</span> = <span class="title function_ invoke__">pg_fetch_assoc</span>(<span class="variable">$borrowResult</span>);</span><br><span class="line">        <span class="variable">$currentBorrows</span> = (<span class="keyword">int</span>)<span class="variable">$borrowData</span>[<span class="string">&#x27;current_borrows&#x27;</span>];</span><br><span class="line">        <span class="variable">$maxLimit</span> = (<span class="keyword">int</span>)<span class="variable">$user</span>[<span class="string">&#x27;max_borrow_limit&#x27;</span>];</span><br><span class="line">        <span class="variable">$eligible</span> = <span class="variable">$currentBorrows</span> &lt; <span class="variable">$maxLimit</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">&#x27;eligible&#x27;</span> =&gt; <span class="variable">$eligible</span>,</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span> =&gt; <span class="variable">$user</span>[<span class="string">&#x27;name&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;email&#x27;</span> =&gt; <span class="variable">$user</span>[<span class="string">&#x27;email&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;max_borrow_limit&#x27;</span> =&gt; <span class="variable">$maxLimit</span>,</span><br><span class="line">            <span class="string">&#x27;current_borrows&#x27;</span> =&gt; <span class="variable">$currentBorrows</span>,</span><br><span class="line">            <span class="string">&#x27;remaining_limit&#x27;</span> =&gt; <span class="variable">$maxLimit</span> - <span class="variable">$currentBorrows</span>,</span><br><span class="line">            <span class="string">&#x27;message&#x27;</span> =&gt; <span class="variable">$eligible</span> ? <span class="string">&quot;用户借阅资格正常&quot;</span> : <span class="string">&quot;已达到最大借阅数量&quot;</span></span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;db) &#123;</span><br><span class="line">            <span class="title function_ invoke__">pg_close</span>(<span class="variable">$this</span>-&gt;db);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BorrowBookSkill</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$agent</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$agent</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;agent = <span class="variable">$agent</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"><span class="variable">$params</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$userId</span> = <span class="variable">$params</span>[<span class="string">&#x27;user_id&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$bookId</span> = <span class="variable">$params</span>[<span class="string">&#x27;book_id&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$userId</span>) || <span class="keyword">empty</span>(<span class="variable">$bookId</span>)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;缺少必要的参数: user_id 或 book_id&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查用户资格</span></span><br><span class="line">        <span class="variable">$userInfo</span> = <span class="variable language_">$this</span>-&gt;agent-&gt;tools[<span class="string">&#x27;get_user_info&#x27;</span>][<span class="string">&#x27;handler&#x27;</span>]([</span><br><span class="line">            <span class="string">&#x27;user_id&#x27;</span> =&gt; <span class="variable">$userId</span></span><br><span class="line">        ]);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$userInfo</span>[<span class="string">&#x27;eligible&#x27;</span>]) &#123;</span><br><span class="line">            <span class="keyword">return</span> [</span><br><span class="line">                <span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">                <span class="string">&#x27;message&#x27;</span> =&gt; <span class="variable">$userInfo</span>[<span class="string">&#x27;message&#x27;</span>]</span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查图书可用性</span></span><br><span class="line">        <span class="variable">$availability</span> = <span class="variable language_">$this</span>-&gt;agent-&gt;tools[<span class="string">&#x27;check_availability&#x27;</span>][<span class="string">&#x27;handler&#x27;</span>]([</span><br><span class="line">            <span class="string">&#x27;book_id&#x27;</span> =&gt; <span class="variable">$bookId</span></span><br><span class="line">        ]);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$availability</span>[<span class="string">&#x27;available&#x27;</span>]) &#123;</span><br><span class="line">            <span class="keyword">return</span> [</span><br><span class="line">                <span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">                <span class="string">&#x27;message&#x27;</span> =&gt; <span class="variable">$availability</span>[<span class="string">&#x27;message&#x27;</span>]</span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 执行借阅</span></span><br><span class="line">        <span class="variable">$borrowDate</span> = <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d&#x27;</span>);</span><br><span class="line">        <span class="variable">$dueDate</span> = <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d&#x27;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;+14 days&quot;</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$query</span> = <span class="string">&quot;INSERT INTO borrow_records (user_id, book_id, borrow_date, due_date, status) VALUES (<span class="subst">$1</span>, <span class="subst">$2</span>, <span class="subst">$3</span>, <span class="subst">$4</span>, &#x27;borrowed&#x27;) RETURNING id&quot;</span>;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">pg_query_params</span>(<span class="variable">$this</span>-&gt;agent-&gt;db, <span class="variable">$query</span>, [<span class="variable">$userId</span>, <span class="variable">$bookId</span>, <span class="variable">$borrowDate</span>, <span class="variable">$dueDate</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;借阅失败: &quot;</span> . <span class="title function_ invoke__">pg_last_error</span>(<span class="variable">$this</span>-&gt;agent-&gt;db));</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$record</span> = <span class="title function_ invoke__">pg_fetch_assoc</span>(<span class="variable">$result</span>);</span><br><span class="line">        <span class="variable">$transactionId</span> = <span class="variable">$record</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">            <span class="string">&#x27;transaction_id&#x27;</span> =&gt; <span class="variable">$transactionId</span>,</span><br><span class="line">            <span class="string">&#x27;due_date&#x27;</span> =&gt; <span class="variable">$dueDate</span>,</span><br><span class="line">            <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&quot;借阅成功！请在<span class="subst">&#123;$dueDate&#125;</span>前归还。&quot;</span></span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDescription</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;处理图书借阅请求，验证用户资格和图书可用性&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="variable">$config</span> = [</span><br><span class="line">    <span class="string">&#x27;database_url&#x27;</span> =&gt; <span class="string">&#x27;host=localhost dbname=library_db user=library_user password=password&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;openai_api_key&#x27;</span> =&gt; <span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>)</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$agent</span> = <span class="keyword">new</span> <span class="title class_">LibraryAgent</span>(<span class="variable">$config</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 执行借书技能</span></span><br><span class="line">    <span class="variable">$result</span> = <span class="variable">$agent</span>-&gt;<span class="title function_ invoke__">executeSkill</span>(<span class="string">&#x27;borrow_book&#x27;</span>, [</span><br><span class="line">        <span class="string">&#x27;user_id&#x27;</span> =&gt; <span class="string">&#x27;user123&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;book_id&#x27;</span> =&gt; <span class="string">&#x27;book456&#x27;</span></span><br><span class="line">    ]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$result</span>, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE);</span><br><span class="line">    </span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;错误: &quot;</span> . <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="六、性能优化与监控"><a href="#六、性能优化与监控" class="headerlink" title="六、性能优化与监控"></a>六、性能优化与监控</h2><h3 id="6-1-性能优化策略"><a href="#6-1-性能优化策略" class="headerlink" title="6.1 性能优化策略"></a>6.1 性能优化策略</h3><ol><li><strong>技能缓存</strong>：对频繁调用的Skills结果进行缓存，减少重复计算</li><li><strong>连接池优化</strong>：合理配置数据库连接池大小，避免连接泄漏</li><li><strong>异步执行</strong>：对于耗时操作，使用异步任务队列处理</li><li><strong>批处理</strong>：合并多个相似请求，减少数据库查询次数</li><li><strong>索引优化</strong>：为常用查询字段创建合适的索引</li></ol><h3 id="6-2-监控指标设计"><a href="#6-2-监控指标设计" class="headerlink" title="6.2 监控指标设计"></a>6.2 监控指标设计</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># prometheus.yml</span></span><br><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;library-agent&#x27;</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;agent-service:9090&#x27;</span>]</span><br><span class="line">    <span class="attr">metrics_path:</span> <span class="string">&#x27;/metrics&#x27;</span></span><br><span class="line">    <span class="attr">scrape_interval:</span> <span class="string">15s</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关键监控指标</span></span><br><span class="line"><span class="attr">metrics:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;agent_skill_execution_count&quot;</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;counter&quot;</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&quot;技能执行次数统计&quot;</span></span><br><span class="line">    <span class="attr">labels:</span> [<span class="string">&quot;skill_name&quot;</span>, <span class="string">&quot;status&quot;</span>]</span><br><span class="line">  </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;agent_skill_execution_duration_seconds&quot;</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;histogram&quot;</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&quot;技能执行耗时分布&quot;</span></span><br><span class="line">    <span class="attr">labels:</span> [<span class="string">&quot;skill_name&quot;</span>]</span><br><span class="line">  </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;agent_database_connections&quot;</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;gauge&quot;</span> </span><br><span class="line">    <span class="attr">description:</span> <span class="string">&quot;数据库连接数&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;agent_memory_usage_mb&quot;</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;gauge&quot;</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&quot;内存使用量&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;agent_request_queue_length&quot;</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;gauge&quot;</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&quot;请求队列长度&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;agent_error_count&quot;</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;counter&quot;</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&quot;错误次数统计&quot;</span></span><br><span class="line">    <span class="attr">labels:</span> [<span class="string">&quot;error_type&quot;</span>, <span class="string">&quot;skill_name&quot;</span>]</span><br></pre></td></tr></table></figure><h2 id="七、安全加固措施"><a href="#七、安全加固措施" class="headerlink" title="七、安全加固措施"></a>七、安全加固措施</h2><h3 id="7-1-安全架构设计"><a href="#7-1-安全架构设计" class="headerlink" title="7.1 安全架构设计"></a>7.1 安全架构设计</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">┌─────────────────────────────────────────────────────────────┐</span><br><span class="line">│                      安全防护层                               |</span><br><span class="line">│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │</span><br><span class="line">│  │  输入验证    │  | 权限控制      │  │ 沙箱隔离     │          │</span><br><span class="line">│  │ (Validation)│  │ (RBAC)      │  │ (Sandbox)   │          │</span><br><span class="line">│  └─────────────┘  └─────────────┘  └─────────────┘          │</span><br><span class="line">└───────────────────────────┬─────────────────────────────────┘</span><br><span class="line">                            │</span><br><span class="line">┌───────────────────────────▼─────────────────────────────────┐</span><br><span class="line">│                      应用层                                  │</span><br><span class="line">│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │</span><br><span class="line">│  │  Agent      |  │ Skills      │  │   Log       │          │</span><br><span class="line">|  |    核心      |  |   管理      ｜  |  日志审计    |          |    </span><br><span class="line">│  │ (Core)      │  │ (Registry)  │  │ (Audit)     │          │</span><br><span class="line">│  └─────────────┘  └─────────────┘  └─────────────┘          │</span><br><span class="line">└─────────────────────────────────────────────────────────────┘</span><br></pre></td></tr></table></figure><h3 id="7-2-关键安全措施（建议）"><a href="#7-2-关键安全措施（建议）" class="headerlink" title="7.2 关键安全措施（建议）"></a>7.2 关键安全措施（建议）</h3><ol><li><strong>输入验证</strong>：对所有用户输入进行严格验证和过滤</li><li><strong>权限控制</strong>：基于角色的访问控制（RBAC），最小权限原则</li><li><strong>沙箱隔离</strong>：Skills在独立的沙箱环境中执行，限制系统访问</li><li><strong>数据加密</strong>：敏感数据在传输和存储时进行加密</li><li><strong>审计日志</strong>：记录所有关键操作，便于安全审计和问题追踪</li><li><strong>速率限制</strong>：防止API滥用和DDoS攻击</li><li><strong>安全更新</strong>：定期更新依赖库，修复已知安全漏洞</li></ol><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>Agent与Skills的关系架构代表了现代AI系统设计的新范式，通过将复杂的业务逻辑分解为可复用的Skills，Agent能够更加灵活、智能地处理各种任务。本文基于Debian 12环境，从原理到实践，全面介绍了这一架构的设计、实现和部署。LangChain框架为开发者提供了强大的工具和预构建的架构，让构建AI agents变得更加高效。</p><p>在图书馆借书管理系统的实战Demo中，我们看到了如何将理论知识应用到具体业务场景，通过Python、Go、PHP三种主流语言的实现，展示了Skills架构的跨语言特性。 无论选择哪种技术栈，核心的设计原则都是相同的：模块化、可复用、安全可靠。</p><p>随着AI技术的不断发展，Agent-Skills架构将继续演进，支持更复杂的多Agent协同、更智能的技能发现和组合机制。作为开发者，我们需要持续关注这一领域的发展，掌握最新的设计模式和最佳实践，构建更加智能、可靠的应用系统。</p><p><strong>个人建议</strong>：技术的核心是解决问题，而不是追逐潮流。在设计Agent-Skills架构时，始终要从业务需求出发，选择最适合的技术方案，而不是最流行的技术方案。只有这样，我们才能构建真正有价值的AI系统。<strong>skill本身也许是一种解决方案，但绝不是唯一的最佳解决方案，随着模型的能力进一步发展，针对企业级场景应该会有更好的解决方案。</strong>。</p></div></article></div><script src="/js/mermaid.min.js"></script><div class="card"><div class="card-image"><a class="image is-7by3" href="/8bbd939d.html"><img class="fill" src="/assets/images/php01.jpg" alt="PHP关键版本演进史：从7.4到8.4的完整变迁、注意事项解析"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2026-01-07T15:13:57.000Z" title="1/7/2026, 11:13:57 PM">2026-01-07</time></span><span class="level-item">Updated&nbsp;<time datetime="2026-01-08T09:33:59.895Z" title="1/8/2026, 5:33:59 PM">2026-01-08</time></span><span class="level-item"> Jaco Liu </span><span class="level-item"><a class="link-muted" href="/categories/php/">php</a></span><span class="level-item">43 minutes read (About 6517 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/8bbd939d.html">PHP关键版本演进史：从7.4到8.4的完整变迁、注意事项解析</a></h1><div class="content"><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>PHP作为全球最流行的服务器端脚本语言之一，其版本迭代始终备受开发者关注。<br>“PHP是世界上最好的编程语言”，曾经被无数人调侃讽刺，但PHP依然是编程语言的主力语言，足够简洁、实用，尤其在引入JIT的特性下，PHP未来可期。</p><hr><h2 id="📅-版本时间线概览"><a href="#📅-版本时间线概览" class="headerlink" title="📅 版本时间线概览"></a>📅 版本时间线概览</h2><ul><li><strong>PHP 7.4</strong> - 2019年11月28日发布</li><li><strong>PHP 8.0</strong> - 2020年11月26日发布</li><li><strong>PHP 8.1</strong> - 2021年11月25日发布</li><li><strong>PHP 8.2</strong> - 2022年12月8日发布</li><li><strong>PHP 8.3</strong> - 2023年11月23日发布</li><li><strong>PHP 8.4</strong> - 2024年11月21日发布</li></ul><hr></div><a class="article-more button is-small is-size-7" href="/8bbd939d.html#more">Read more</a></article></div><script src="/js/mermaid.min.js"></script><div class="card"><div class="card-image"><a class="image is-7by3" href="/46b9fbaf.html"><img class="fill" src="/assets/images/db.jpg" alt="MongoDB深度解析实战指南：从原理到生产部署以及主流语言实践"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2026-01-03T15:17:29.000Z" title="1/3/2026, 11:17:29 PM">2026-01-03</time></span><span class="level-item">Updated&nbsp;<time datetime="2026-01-22T06:09:26.594Z" title="1/22/2026, 2:09:26 PM">2026-01-22</time></span><span class="level-item"> Jaco Liu </span><span class="level-item"><a class="link-muted" href="/categories/nosql/">nosql</a></span><span class="level-item">an hour read (About 9543 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/46b9fbaf.html">MongoDB深度解析实战指南：从原理到生产部署以及主流语言实践</a></h1><div class="content"><hr><h2 id="一、MongoDB核心原理与数据结构深度解析"><a href="#一、MongoDB核心原理与数据结构深度解析" class="headerlink" title="一、MongoDB核心原理与数据结构深度解析"></a>一、MongoDB核心原理与数据结构深度解析</h2><p>本文涉及Demo代码示例以常用Debian 12 LTS版系统环境为例，此也是个人常用开发测试系统版本，推荐：</p><blockquote><p><strong>适用版本</strong>：MongoDB 7.0 LTS (最新稳定版)<br><strong>操作系统</strong>：Debian 12 (Bookworm)</p></blockquote><h3 id="1-1-文档数据库的本质"><a href="#1-1-文档数据库的本质" class="headerlink" title="1.1 文档数据库的本质"></a>1.1 文档数据库的本质</h3><p>MongoDB作为面向文档的NoSQL数据库，其核心设计理念是<strong>灵活的模式</strong>（Schema-less）与<strong>JSON-like文档存储</strong>。<br>与传统关系型数据库的行&#x2F;列结构不同，MongoDB以BSON（Binary JSON）格式存储数据，每个文档都是自包含的、具有动态结构的独立单元。</p></div><a class="article-more button is-small is-size-7" href="/46b9fbaf.html#more">Read more</a></article></div><script src="/js/mermaid.min.js"></script><div class="card"><div class="card-image"><a class="image is-7by3" href="/5e9a274.html"><img class="fill" src="/assets/images/javascript01.jpg" alt="JavaScript ES5到ES16版本演进凝思：语法特性差异对比详解（含完整发布时间线梳理）"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2025-12-30T15:17:39.000Z" title="12/30/2025, 11:17:39 PM">2025-12-30</time></span><span class="level-item">Updated&nbsp;<time datetime="2025-12-31T09:42:23.135Z" title="12/31/2025, 5:42:23 PM">2025-12-31</time></span><span class="level-item"> Jaco Liu </span><span class="level-item"><a class="link-muted" href="/categories/javascript/">javascript</a></span><span class="level-item">25 minutes read (About 3690 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/5e9a274.html">JavaScript ES5到ES16版本演进凝思：语法特性差异对比详解（含完整发布时间线梳理）</a></h1><div class="content"><h1><a href="#" class="headerlink"></a></h1><h2 id="标准规范ECMAScript对JavaScript的影响"><a href="#标准规范ECMAScript对JavaScript的影响" class="headerlink" title="标准规范ECMAScript对JavaScript的影响"></a>标准规范ECMAScript对JavaScript的影响</h2><p>JavaScript作为Web开发的核心语言，其标准规范ECMAScript（简称ES）自1997年诞生以来持续演进。从ES5到最新的ES16，每个版本都带来了革命性的变化，重塑了现代前端开发的面貌。本文将系统梳理这些版本间的完整演进历程，包含精确的发布时间、核心特性及注意事项，帮助开发者快速全面掌握JavaScript的现代化发展脉络。<br>在不同编程语言之间相互借鉴的今天，JavaScript依然生命力顽强，这是其语言魅力和生产力的结合。</p></div><a class="article-more button is-small is-size-7" href="/5e9a274.html#more">Read more</a></article></div><script src="/js/mermaid.min.js"></script><div class="card"><div class="card-image"><a class="image is-7by3" href="/2d0307b0.html"><img class="fill" src="/assets/images/db.jpg" alt="PostgreSQL深度实践：从Debian 12入门到集群部署及多语言应用"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2025-12-17T15:37:19.000Z" title="12/17/2025, 11:37:19 PM">2025-12-17</time></span><span class="level-item">Updated&nbsp;<time datetime="2026-01-21T10:41:22.967Z" title="1/21/2026, 6:41:22 PM">2026-01-21</time></span><span class="level-item"> Jaco Liu </span><span class="level-item"><a class="link-muted" href="/categories/Database/">Database</a></span><span class="level-item">an hour read (About 6890 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2d0307b0.html">PostgreSQL深度实践：从Debian 12入门到集群部署及多语言应用</a></h1><div class="content"><h2 id="PG简述"><a href="#PG简述" class="headerlink" title="PG简述"></a>PG简述</h2><p>PostgreSQL作为世界上最先进的开源关系型数据库系统，凭借其强大的功能、卓越的性能和严格的ACID特性，已经成为企业级应用的首选数据库之一。<br>本文将带领读者从零开始，在Debian 12环境下深入掌握PostgreSQL，涵盖版本演进、核心原理、实战配置、集群部署以及多语言应用开发，为数据库工程师和开发者提供一套完整的实践指南，包含常用的一些语法操作和最佳实践等等。</p></div><a class="article-more button is-small is-size-7" href="/2d0307b0.html#more">Read more</a></article></div><script src="/js/mermaid.min.js"></script><div class="card"><div class="card-image"><a class="image is-7by3" href="/4adbc11a.html"><img class="fill" src="/assets/images/ai-logo.png" alt="Discussion and analysis of Text2SQL technology, the most difficult pain point in the commercial implementation of agents.（Agent 商业落地里最难的痛点 Text2SQL 技术探讨和解析）"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2025-12-03T14:29:12.000Z" title="12/3/2025, 10:29:12 PM">2025-12-03</time></span><span class="level-item">Updated&nbsp;<time datetime="2025-12-24T09:46:05.306Z" title="12/24/2025, 5:46:05 PM">2025-12-24</time></span><span class="level-item"> Jaco Liu </span><span class="level-item"><a class="link-muted" href="/categories/AI/">AI</a><span> / </span><a class="link-muted" href="/categories/AI/Agent/">Agent</a></span><span class="level-item">39 minutes read (About 5898 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/4adbc11a.html">Discussion and analysis of Text2SQL technology, the most difficult pain point in the commercial implementation of agents.（Agent 商业落地里最难的痛点 Text2SQL 技术探讨和解析）</a></h1><div class="content"><h3 id="Agent-商业落地里最难的是-Text2SQL（NL2SQL），几乎是无法绕开的核心痛点，主要面临的三个核心问题："><a href="#Agent-商业落地里最难的是-Text2SQL（NL2SQL），几乎是无法绕开的核心痛点，主要面临的三个核心问题：" class="headerlink" title="Agent 商业落地里最难的是 Text2SQL（NL2SQL），几乎是无法绕开的核心痛点，主要面临的三个核心问题："></a>Agent 商业落地里最难的是 Text2SQL（NL2SQL），几乎是无法绕开的核心痛点，主要面临的三个核心问题：</h3><ul><li>为什么到目前为止仍然没有真正可靠的商业共识性企业级解决方案？</li><li>实际企业应用场景中，有哪些靠谱的思路和解决方案？</li><li>是依托专有小模型还是基于模版宏套用替换变量的方式？</li><li>如果是你，你怎么设计一个准确率足够高的 text2sql 引擎？</li></ul><p>这是一个非常深刻且直击要害的商业落地问题。Text-to-SQL（或者说，更广义的 NL2SQL&#x2F;Text2Analytics）下面我将从“为什么难”、“现有靠谱的思路”以及“技术选型”三个层面，系统地拆解这个问题。</p></div><a class="article-more button is-small is-size-7" href="/4adbc11a.html#more">Read more</a></article></div><script src="/js/mermaid.min.js"></script><div class="card"><div class="card-image"><a class="image is-7by3" href="/225323a0.html"><img class="fill" src="/assets/images/ai-logo.png" alt="Ultimate Guide to Quantizing AI Large Language Models: From FP32 to INT4, How to Make Large Models Perform at Full Speed on Consumer Devices?（AI 大语言模型量化终极指南：从 FP32 到 INT4，如何让大模型在消费级设备部署应用及选型？）"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2025-12-02T14:29:13.000Z" title="12/2/2025, 10:29:13 PM">2025-12-02</time></span><span class="level-item">Updated&nbsp;<time datetime="2025-12-24T09:46:05.304Z" title="12/24/2025, 5:46:05 PM">2025-12-24</time></span><span class="level-item"> Jaco Liu </span><span class="level-item"><a class="link-muted" href="/categories/AI/">AI</a><span> / </span><a class="link-muted" href="/categories/AI/Agent/">Agent</a></span><span class="level-item">11 minutes read (About 1699 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/225323a0.html">Ultimate Guide to Quantizing AI Large Language Models: From FP32 to INT4, How to Make Large Models Perform at Full Speed on Consumer Devices?（AI 大语言模型量化终极指南：从 FP32 到 INT4，如何让大模型在消费级设备部署应用及选型？）</a></h1><div class="content"><p><strong>——深度解析量化格式、尺寸差异与硬件适配策略（附 M3 Pro 实战指南）</strong></p><p>个人常用办公终端设备型号：</p><ul><li><strong>Macbook Pro M3 （36G 内存定制款)</strong></li></ul><blockquote><p><strong>小结</strong>：</p><ul><li>💡 <strong>Apple 用户闭眼选 BF16</strong>：M3 Pro 芯片的 BF16 性能碾压 FP16，18GB 内存可流畅运行 30B 级模型</li><li>⚠️ <strong>INT4 是双刃剑</strong>：70B 模型塞进 36GB 内存的唯一方案，但精度损失高达 15%+</li><li>🔮 <strong>未来属于 FP8</strong>：NVIDIA H100 已支持，苹果 M4 或成转折点</li></ul></blockquote><hr></div><a class="article-more button is-small is-size-7" href="/225323a0.html#more">Read more</a></article></div><script src="/js/mermaid.min.js"></script><div class="card"><div class="card-image"><a class="image is-7by3" href="/edd96fdf.html"><img class="fill" src="/assets/images/ai-logo.png" alt="基于 Golang 模拟实现一个简化的 DeepSeek AI 模型 GRPO 算法推理"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2025-12-01T14:12:43.000Z" title="12/1/2025, 10:12:43 PM">2025-12-01</time></span><span class="level-item">Updated&nbsp;<time datetime="2026-01-16T04:39:54.786Z" title="1/16/2026, 12:39:54 PM">2026-01-16</time></span><span class="level-item"> Jaco Liu </span><span class="level-item"><a class="link-muted" href="/categories/AI/">AI</a><span> / </span><a class="link-muted" href="/categories/AI/Algo/">Algo</a></span><span class="level-item">15 minutes read (About 2282 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/edd96fdf.html">基于 Golang 模拟实现一个简化的 DeepSeek AI 模型 GRPO 算法推理</a></h1><div class="content"><h3 id="模拟实现一个简化的-GRPO-Group-Relative-Policy-Optimization-推理模型。GRPO-是由-DeepSeek-提出的强化学习算法，用于训练大型语言模型"><a href="#模拟实现一个简化的-GRPO-Group-Relative-Policy-Optimization-推理模型。GRPO-是由-DeepSeek-提出的强化学习算法，用于训练大型语言模型" class="headerlink" title="模拟实现一个简化的 GRPO (Group Relative Policy Optimization) 推理模型。GRPO 是由 DeepSeek 提出的强化学习算法，用于训练大型语言模型"></a>模拟实现一个简化的 GRPO (Group Relative Policy Optimization) 推理模型。GRPO 是由 DeepSeek 提出的强化学习算法，用于训练大型语言模型</h3><p>它的核心特点是不需要训练价值函数，而是通过从同一问题的多个输出中计算平均奖励来替代这一过程，显著减少了内存和计算资源的消耗 。</p><p>简化版 GRPO 推理模型：</p></div><a class="article-more button is-small is-size-7" href="/edd96fdf.html#more">Read more</a></article></div><script src="/js/mermaid.min.js"></script><div class="card"><div class="card-image"><a class="image is-7by3" href="/fcaf092e.html"><img class="fill" src="/assets/images/db.jpg" alt="深度解析 PostgreSQL 引擎：设计原理、实现机制与性能优化"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2025-11-22T11:18:13.000Z" title="11/22/2025, 7:18:13 PM">2025-11-22</time></span><span class="level-item">Updated&nbsp;<time datetime="2025-12-24T09:46:05.326Z" title="12/24/2025, 5:46:05 PM">2025-12-24</time></span><span class="level-item"> Jaco Liu </span><span class="level-item"><a class="link-muted" href="/categories/Database/">Database</a></span><span class="level-item">an hour read (About 12081 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/fcaf092e.html">深度解析 PostgreSQL 引擎：设计原理、实现机制与性能优化</a></h1><div class="content"><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p><strong>“当你不能用简单的语言来描述一件事情时，说明你没弄懂它。” ————费曼</strong></p><p>在当今数据驱动的时代，数据库系统作为企业核心基础设施的重要性不言而喻。PostgreSQL 作为世界上最先进的开源关系型数据库管理系统，凭借其卓越的稳定性、强大的功能集和优秀的性能表现，已经成为众多企业和开发者的首选。自 1986 年诞生以来，PostgreSQL 经历了近四十年的发展历程，从最初的”Ingres”项目演变为今天功能完备的企业级数据库解决方案。</p><p>本文将深入探讨 PostgreSQL 引擎的核心设计原理、实现机制以及性能特性，为数据库架构师、开发人员和运维工程师提供全面的技术参考。我们将从架构层面开始，逐步深入到存储引擎、事务管理、查询优化等核心组件，最后分析其性能优缺点并提供优化建议。通过本文，读者将获得对 PostgreSQL 内部工作原理的深刻理解，从而在实际应用中能够更好地设计、部署和优化基于 PostgreSQL 的应用系统。</p></div><a class="article-more button is-small is-size-7" href="/fcaf092e.html#more">Read more</a></article></div><script src="/js/mermaid.min.js"></script><div class="card"><div class="card-image"><a class="image is-7by3" href="/bd534bb7.html"><img class="fill" src="/assets/images/db.jpg" alt="postgres 和 mysql 在语法的区别（ PostgreSQL 16 vs MySQL 8.0+，兼容 2025 年现状）"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2025-11-19T14:02:13.000Z" title="11/19/2025, 10:02:13 PM">2025-11-19</time></span><span class="level-item">Updated&nbsp;<time datetime="2025-12-24T09:46:05.323Z" title="12/24/2025, 5:46:05 PM">2025-12-24</time></span><span class="level-item"> Jaco Liu </span><span class="level-item"><a class="link-muted" href="/categories/Database/">Database</a></span><span class="level-item">17 minutes read (About 2599 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/bd534bb7.html">postgres 和 mysql 在语法的区别（ PostgreSQL 16 vs MySQL 8.0+，兼容 2025 年现状）</a></h1><div class="content"><h3 id="postgres-和-mysql-在语法的区别（-PostgreSQL-16-vs-MySQL-8-0-，兼容-2025-年现状）"><a href="#postgres-和-mysql-在语法的区别（-PostgreSQL-16-vs-MySQL-8-0-，兼容-2025-年现状）" class="headerlink" title="postgres 和 mysql 在语法的区别（ PostgreSQL 16 vs MySQL 8.0+，兼容 2025 年现状）"></a>postgres 和 mysql 在语法的区别（ PostgreSQL 16 vs MySQL 8.0+，兼容 2025 年现状）</h3><p>以下是 PostgreSQL 与 MySQL 在语法上的主要区别汇总（截至 PostgreSQL 16 &#x2F; MySQL 8.0+，兼容 2025 年现状）：</p></div><a class="article-more button is-small is-size-7" href="/bd534bb7.html#more">Read more</a></article></div><script src="/js/mermaid.min.js"></script><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/page/0/">Previous</a></div><div class="pagination-next"><a href="/page/2/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/9/">9</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.jpeg" alt="Jaco Liu"></figure><p class="title is-size-4 is-block" style="line-height:inherit">Jaco Liu</p><p class="is-size-6 is-block">Greatness in Simplicity.</p><p class="is-size-6 is-block">Security accompanies every aspect of software development.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>The Earth</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">87</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">27</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">151</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ljq" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/ljqlab"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Gitee" href="https://gitee.com/jqe"><i class="fab fa-git-square"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ljq"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="clustrmaps"><div class="card-content"><div class="menu"><h3 class="menu-label">CLUSTRMAPS</h3></div><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div style="margin-top:10px"><script type="text/javascript" id="clustrmaps" src="https://cdn.clustrmaps.com/map_v2.js?cl=ffffff&amp;w=250&amp;t=n&amp;d=xb7wV_PHYtl9KaSZpQgP9CLUNrXlqm480vcarJmX2A0&amp;co=2d78ad&amp;cmo=3acc3a&amp;cmn=ff5353&amp;ct=ffffff"></script><script type="text/javascript" id="clstr_globe" src="https://clustrmaps.com/globe.js?d=xb7wV_PHYtl9KaSZpQgP9CLUNrXlqm480vcarJmX2A0"></script></div></div></nav></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://github.com/ljq" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">GitHub</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li><li><a class="level is-mobile" href="https://gitee.com/jqe" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Gitee</span></span><span class="level-right"><span class="level-item tag">gitee.com</span></span></a></li><li><a class="level is-mobile" href="https://ref.wdft.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Quick Reference</span></span><span class="level-right"><span class="level-item tag">ref.wdft.com</span></span></a></li><li><a class="level is-mobile" href="https://cook.wdft.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Cook</span></span><span class="level-right"><span class="level-item tag">cook.wdft.com</span></span></a></li><li><a class="level is-mobile" href="https://pep8.org" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Python PEP8</span></span><span class="level-right"><span class="level-item tag">pep8.org</span></span></a></li><li><a class="level is-mobile" href="https://news.ycombinator.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">HackerNews</span></span><span class="level-right"><span class="level-item tag">news.ycombinator.com</span></span></a></li><li><a class="level is-mobile" href="https://koala-oss.app/news/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Koala-oss.app</span></span><span class="level-right"><span class="level-item tag">koala-oss.app</span></span></a></li></ul></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2026/01/"><span class="level-start"><span class="level-item">January 2026</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/12/"><span class="level-start"><span class="level-item">December 2025</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/11/"><span class="level-start"><span class="level-item">November 2025</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/10/"><span class="level-start"><span class="level-item">October 2025</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/06/"><span class="level-start"><span class="level-item">June 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/05/"><span class="level-start"><span class="level-item">May 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/02/"><span class="level-start"><span class="level-item">February 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/01/"><span class="level-start"><span class="level-item">January 2025</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/12/"><span class="level-start"><span class="level-item">December 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/11/"><span class="level-start"><span class="level-item">November 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/09/"><span class="level-start"><span class="level-item">September 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/07/"><span class="level-start"><span class="level-item">July 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">June 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">May 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/03/"><span class="level-start"><span class="level-item">March 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">February 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/11/"><span class="level-start"><span class="level-item">November 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/10/"><span class="level-start"><span class="level-item">October 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/08/"><span class="level-start"><span class="level-item">August 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">June 2023</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/04/"><span class="level-start"><span class="level-item">April 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">February 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">August 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">June 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/03/"><span class="level-start"><span class="level-item">March 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8952360410310192" data-ad-slot="1345698037" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/65d4601b.html"><img src="/assets/images/ai-logo.png" alt="Agent 与 Skills 之间的区别通过一个简单图书馆借阅系统案例实践指南"></a></figure><div class="media-content"><p class="date"><time datetime="2026-01-24T13:25:24.000Z">2026-01-24</time></p><p class="title"><a href="/65d4601b.html">Agent 与 Skills 之间的区别通过一个简单图书馆借阅系统案例实践指南</a></p><p class="categories"><a href="/categories/AI/">AI</a> / <a href="/categories/AI/Agent/">Agent</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/8bbd939d.html"><img src="/assets/images/php01.jpg" alt="PHP关键版本演进史：从7.4到8.4的完整变迁、注意事项解析"></a></figure><div class="media-content"><p class="date"><time datetime="2026-01-07T15:13:57.000Z">2026-01-07</time></p><p class="title"><a href="/8bbd939d.html">PHP关键版本演进史：从7.4到8.4的完整变迁、注意事项解析</a></p><p class="categories"><a href="/categories/php/">php</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/46b9fbaf.html"><img src="/assets/images/db.jpg" alt="MongoDB深度解析实战指南：从原理到生产部署以及主流语言实践"></a></figure><div class="media-content"><p class="date"><time datetime="2026-01-03T15:17:29.000Z">2026-01-03</time></p><p class="title"><a href="/46b9fbaf.html">MongoDB深度解析实战指南：从原理到生产部署以及主流语言实践</a></p><p class="categories"><a href="/categories/nosql/">nosql</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/5e9a274.html"><img src="/assets/images/javascript01.jpg" alt="JavaScript ES5到ES16版本演进凝思：语法特性差异对比详解（含完整发布时间线梳理）"></a></figure><div class="media-content"><p class="date"><time datetime="2025-12-30T15:17:39.000Z">2025-12-30</time></p><p class="title"><a href="/5e9a274.html">JavaScript ES5到ES16版本演进凝思：语法特性差异对比详解（含完整发布时间线梳理）</a></p><p class="categories"><a href="/categories/javascript/">javascript</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2d0307b0.html"><img src="/assets/images/db.jpg" alt="PostgreSQL深度实践：从Debian 12入门到集群部署及多语言应用"></a></figure><div class="media-content"><p class="date"><time datetime="2025-12-17T15:37:19.000Z">2025-12-17</time></p><p class="title"><a href="/2d0307b0.html">PostgreSQL深度实践：从Debian 12入门到集群部署及多语言应用</a></p><p class="categories"><a href="/categories/Database/">Database</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AI/"><span class="level-start"><span class="level-item">AI</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/AI/AIGC/"><span class="level-start"><span class="level-item">AIGC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/AI/Agent/"><span class="level-start"><span class="level-item">Agent</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/AI/Algo/"><span class="level-start"><span class="level-item">Algo</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/GIT/"><span class="level-start"><span class="level-item">GIT</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Go/"><span class="level-start"><span class="level-item">Go</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile" href="/categories/architecture/"><span class="level-start"><span class="level-item">architecture</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/clang/"><span class="level-start"><span class="level-item">clang</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/cloud/"><span class="level-start"><span class="level-item">cloud</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/daily/"><span class="level-start"><span class="level-item">daily</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul><li><a class="level is-mobile" href="/categories/daily/business/"><span class="level-start"><span class="level-item">business</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/daily/note/"><span class="level-start"><span class="level-item">note</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/java/"><span class="level-start"><span class="level-item">java</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/javascript/"><span class="level-start"><span class="level-item">javascript</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/linux/"><span class="level-start"><span class="level-item">linux</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/linux/centos/"><span class="level-start"><span class="level-item">centos</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/linux/debian/"><span class="level-start"><span class="level-item">debian</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/linux/tools/"><span class="level-start"><span class="level-item">tools</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/lua/"><span class="level-start"><span class="level-item">lua</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/macOS/"><span class="level-start"><span class="level-item">macOS</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/message/"><span class="level-start"><span class="level-item">message</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/nosql/"><span class="level-start"><span class="level-item">nosql</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/olap/"><span class="level-start"><span class="level-item">olap</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/php/"><span class="level-start"><span class="level-item">php</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/python/"><span class="level-start"><span class="level-item">python</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/reprinted-articles/"><span class="level-start"><span class="level-item">reprinted-articles</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AIGC/"><span class="tag">AIGC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Agent/"><span class="tag">Agent</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Agent-Skill/"><span class="tag">Agent-Skill</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Agent-framework/"><span class="tag">Agent-framework</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Algorithm/"><span class="tag">Algorithm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CDN/"><span class="tag">CDN</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cloud-Distributed/"><span class="tag">Cloud-Distributed</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cloud-Native/"><span class="tag">Cloud-Native</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cloud-Native-Framework/"><span class="tag">Cloud-Native-Framework</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Controlnet/"><span class="tag">Controlnet</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DDD/"><span class="tag">DDD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DeepSeek/"><span class="tag">DeepSeek</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Deepseek/"><span class="tag">Deepseek</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Demo-AI/"><span class="tag">Demo-AI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Distributed-Systems/"><span class="tag">Distributed-Systems</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Drawing/"><span class="tag">Drawing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ES/"><span class="tag">ES</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Elastic/"><span class="tag">Elastic</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ElasticSearch/"><span class="tag">ElasticSearch</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Framework/"><span class="tag">Framework</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GGUF/"><span class="tag">GGUF</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GIT/"><span class="tag">GIT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GO-%E6%96%B9%E6%B3%95%E5%80%BC/"><span class="tag">GO 方法值</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GPG/"><span class="tag">GPG</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GPG2/"><span class="tag">GPG2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GRPO/"><span class="tag">GRPO</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GUI/"><span class="tag">GUI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ghostty/"><span class="tag">Ghostty</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go/"><span class="tag">Go</span><span class="tag">27</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-Summary-notes/"><span class="tag">Go Summary notes</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-null-judge/"><span class="tag">Go null judge</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-Struct-Method-Receiver/"><span class="tag">Go(Struct|Method|Receiver)</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-map/"><span class="tag">Go(map)</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-new-make-struct/"><span class="tag">Go(new,make,struct{})</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-string/"><span class="tag">Go(string)</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-Polymorphism/"><span class="tag">Go-Polymorphism</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-Printf/"><span class="tag">Go-Printf</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-chain-operation/"><span class="tag">Go-chain-operation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go-init/"><span class="tag">Go-init()</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Golang/"><span class="tag">Golang</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Google/"><span class="tag">Google</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/History/"><span class="tag">History</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Infra/"><span class="tag">Infra</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JS/"><span class="tag">JS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JSON/"><span class="tag">JSON</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java17/"><span class="tag">Java17</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java8/"><span class="tag">Java8</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/K3S-Build/"><span class="tag">K3S-Build</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/K8S/"><span class="tag">K8S</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/K8S-Build/"><span class="tag">K8S-Build</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kafka/"><span class="tag">Kafka</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Message/"><span class="tag">Message</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Microservices/"><span class="tag">Microservices</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MongoDB/"><span class="tag">MongoDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Movie/"><span class="tag">Movie</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Note-The-Legend-of-1900/"><span class="tag">Note The Legend of 1900</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OLAP/"><span class="tag">OLAP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OpenSSH/"><span class="tag">OpenSSH</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Qwen/"><span class="tag">Qwen</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RabbitMQ/"><span class="tag">RabbitMQ</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Redis/"><span class="tag">Redis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SD/"><span class="tag">SD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Skill/"><span class="tag">Skill</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/StarRocks/"><span class="tag">StarRocks</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Syntax/"><span class="tag">Syntax</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TS/"><span class="tag">TS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Text2SQL/"><span class="tag">Text2SQL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TypeScript/"><span class="tag">TypeScript</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VIM/"><span class="tag">VIM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VIM-Author/"><span class="tag">VIM Author</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/XHProf/"><span class="tag">XHProf</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ansi-lib/"><span class="tag">ansi-lib</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/banner/"><span class="tag">banner</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/business/"><span class="tag">business</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/centos7/"><span class="tag">centos7</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/changelog/"><span class="tag">changelog</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/chattr/"><span class="tag">chattr</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clang/"><span class="tag">clang</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cli/"><span class="tag">cli</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/daily/"><span class="tag">daily</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/debian/"><span class="tag">debian</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firewalld/"><span class="tag">firewalld</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/format/"><span class="tag">format</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/func/"><span class="tag">func</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/go-pprof/"><span class="tag">go-pprof</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/goroutine/"><span class="tag">goroutine</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/history/"><span class="tag">history</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/history-of-programing/"><span class="tag">history-of-programing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/homebrew/"><span class="tag">homebrew</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/interface/"><span class="tag">interface</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/io/"><span class="tag">io</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kebernetes/"><span class="tag">kebernetes</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/laravel/"><span class="tag">laravel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/laravel-artisan/"><span class="tag">laravel-artisan</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/learn/"><span class="tag">learn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/lua/"><span class="tag">lua</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macro/"><span class="tag">macro</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/motd/"><span class="tag">motd</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql/"><span class="tag">mysql</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql8-0/"><span class="tag">mysql8.0</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql8-x/"><span class="tag">mysql8.x</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nanochat/"><span class="tag">nanochat</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nanochat-zh-CN/"><span class="tag">nanochat-zh_CN</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/neofetch/"><span class="tag">neofetch</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nginx/"><span class="tag">nginx</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nosql/"><span class="tag">nosql</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/oh-my-zsh/"><span class="tag">oh-my-zsh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/omz/"><span class="tag">omz</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/openssl/"><span class="tag">openssl</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/package-time/"><span class="tag">package time</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/painting/"><span class="tag">painting</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/php/"><span class="tag">php</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pointer/"><span class="tag">pointer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postgresql/"><span class="tag">postgresql</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postgresql-syntax/"><span class="tag">postgresql-syntax</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postgressql-engine/"><span class="tag">postgressql-engine</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reflect-%E5%8F%8D%E5%B0%84/"><span class="tag">reflect 反射</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rocky/"><span class="tag">rocky</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rocky-linux/"><span class="tag">rocky-linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rocky-linux-tools/"><span class="tag">rocky-linux-tools</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rsync/"><span class="tag">rsync</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rune/"><span class="tag">rune</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/services/"><span class="tag">services</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/slice-%E5%88%87%E7%89%87%E6%9C%AC%E8%B4%A8/"><span class="tag">slice 切片本质</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/stable-diffusion-webui/"><span class="tag">stable-diffusion-webui</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/struct/"><span class="tag">struct</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/switch/"><span class="tag">switch</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/systemd-service/"><span class="tag">systemd-service</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/terminal/"><span class="tag">terminal</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/travel/"><span class="tag">travel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/type/"><span class="tag">type</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/type-%E5%85%B3%E9%94%AE%E8%AF%8D%E6%80%BB%E7%BB%93/"><span class="tag">type 关键词总结</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/utf8mb4/"><span class="tag">utf8mb4</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/utf8mb4-0900-ai-ci/"><span class="tag">utf8mb4_0900_ai_ci</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/utf8mb4-general-ci/"><span class="tag">utf8mb4_general_ci</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/zsh/"><span class="tag">zsh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%BA%E7%94%9F/"><span class="tag">人生</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%97%A5%E5%B8%B8/"><span class="tag">日常</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%9F%E6%B4%BB/"><span class="tag">生活</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%BD%AC%E8%BD%BD/"><span class="tag">转载</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BD%93%E7%B3%BB/"><span class="tag">配置文件体系</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%98%B2%E7%81%AB%E5%A2%99/"><span class="tag">防火墙</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer" style="padding:1rem 1.5rem 0"><div class="container"><div class="level"><div class="level-start"><p class="is-size-7"><a class="footer-logo" style="margin-right:10px" href="/"><img src="/img/logo.svg" alt="Jaco Liu Personal Site (ljq@GitHub).安全贯穿于软件开发各个环节." height="16" style="max-height:1.25rem"></a><a href="http://beian.miit.gov.cn" target="_blank">鲁ICP备2023051700号</a>  <span>&copy; 2026 Jaco Liu</span>  <span style="color:#e0e0e0">Powered by <a style="color:#e0e0e0" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a style="color:#e0e0e0" href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>  <span id="busuanzi_container_site_pv">Total Visits Counts: <span id="busuanzi_value_site_pv"></span>.</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Jaco Liu&#039;GitHub" href="https://github.com/ljq"><i class="fab fa-github"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="ref.wdft.com" href="https://ref.wdft.com"><i class="fas fa-cloud"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="cook.wdft.com" href="https://cook.wdft.com"><i class="fas fa-coffee"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Python PEP8" href="https://pep8.org"><i class="fas fa-coffee"></i></a></p> <span><i class="fas fa-link">BlogRoll:</i></span><p class="control" style="color:#26c1fa"><a class="button is-transparent" target="_blank" rel="noopener" title="Quick Reference" href="https://ref.wdft.com">Quick Reference</a></p><p class="control" style="color:#26c1fa"><a class="button is-transparent" target="_blank" rel="noopener" title="Cook" href="https://cook.wdft.com">Cook</a></p><p class="control" style="color:#26c1fa"><a class="button is-transparent" target="_blank" rel="noopener" title="koala-oss.app" href="https://koala-oss.app/news/">koala-oss.app</a></p><p class="control" style="color:#26c1fa"><a class="button is-transparent" target="_blank" rel="noopener" title="CS自学指南" href="https://csdiy.wiki">CS自学指南</a></p><p class="control" style="color:#26c1fa"><a class="button is-transparent" target="_blank" rel="noopener" title="Python PEP8" href="https://pep8.org">Python PEP8</a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("en")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="/js/switchDarkMode.js" defer></script><script src="/js/toutiaoSEO.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load",()=>{window.cookieconsent.initialise({type:"info",theme:"edgeless",static:!1,position:"bottom-left",content:{message:"This website uses cookies to improve your experience.",dismiss:"Got it!",allow:"Allow cookies",deny:"Decline",link:"Learn more",policy:"Cookie Policy",href:"https://www.cookiesandyou.com/"},palette:{popup:{background:"#edeff5",text:"#838391"},button:{background:"#4b81e8"}}})})</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load",()=>{"function"==typeof $.fn.lightGallery&&$(".article").lightGallery({selector:".gallery-item"}),"function"==typeof $.fn.justifiedGallery&&($(".justified-gallery > p > .gallery-item").length&&$(".justified-gallery > p > .gallery-item").unwrap(),$(".justified-gallery").justifiedGallery())})</script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",function(){loadInsight({contentUrl:"/content.json"},{hint:"Type something...",untitled:"(Untitled)",posts:"Posts",pages:"Pages",categories:"Categories",tags:"Tags"})})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"pluginJsPath":"lib/","pluginRootPath":"live2dw/"});</script><script>"use strict";if("serviceWorker"in navigator){navigator.serviceWorker.register("service-worker.js").then((function(reg){reg.onupdatefound=function(){var installingWorker=reg.installing;installingWorker.onstatechange=function(){switch(installingWorker.state){case"installed":if(navigator.serviceWorker.controller){console.log("New or updated content is available.")}else{console.log("Content is now available offline!")}break;case"redundant":console.error("The installing service worker became redundant.");break}}}}))["catch"]((function(e){console.error("Error during service worker registration:",e)}))}</script></body></html>